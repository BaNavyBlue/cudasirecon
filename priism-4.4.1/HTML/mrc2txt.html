<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
  <META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <TITLE>Priism Help: mrc2txt</TITLE>
  <META NAME="Description" CONTENT="On-line help for converter from Priism's native file format to text.">
  <META NAME="Keywords" CONTENT="Priism,convert,text">
  <LINK REV=MADE HREF="mailto:ive@msg.ucsf.edu">
</HEAD>
<BODY>

<H1><A NAME="mrc2txt">Convert from Priism's Native Format to Text</A></H1>
<H2>Overview</H2>
<P>This application takes a Priism file and converts it into one or more
text files.  The conversion is direct: no scaling or transformation of the
data values occurs.

<P>Mrc2txt has the <A HREF="Region.html">standard set of Priism controls</A>
for selecting a subset of the Priism file to convert.  For the conversion,
the key choice that has to be made is whether to convert each section in
the input into a separate file or to place the sections one after the other
in one file.  When multiple output files are to be generated, the important
controls affect the generation of the output file names:  the
<A HREF="#name_format">"Name format" menu</A>,
<A HREF="#output_directory">Directory field</A>,
<A HREF="#output_prefix">Prefix field</A>,
and <A HREF="#template">Template field</A>.  When a single output file is to
be generated, the controls that are important are the "Output file" button to
browse for the output file, the field next to the "Output file" button in
which the output file name can be entered directly, and the
<A HREF="#interleaving">Interleaving menu</A> which controls the ordering of
pages in the output.  For both single and multiple file output, use the
column delimiter menu to select how columns are separated from on another
in the output and the section header field to enter the optional text that
is printed before the start of each section's data.

<H3>Topics</H3>
<P>
    Overview |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    <A HREF="#appends">Appends</A> |
    <A HREF="#section_header">Section header</A> |
    <A HREF="#single_file">Single file</A> |
    <A HREF="#interleaving">Interleaving</A> |
    <A HREF="#name_format">Name format</A> |
    <A HREF="#output_directory">Directory</A> |
    <A HREF="#output_prefix">Prefix</A> |
    <A HREF="#template">Template</A> |
    <A HREF="#CommandLine">Command line</A>

<H3>Related Priism Topics</H3>
<P>
    <A HREF="Priism.html">Priism</A>
<HR>

<H2><A NAME="column_delimiter">Column Delimiter</A></H2>
<P>Use the "Column Delimiter" menu to select what is used to separate
columns in the output.  Because the printed values may be padded with spaces
to ensure a uniform presentation, there can be additional spaces separating
the columns.  The available choices for the column delimiter are:

<DL>
  <DT>space<DD>Each column is separated from the next by a single space.
  <DT>tab<DD>Each column is separated from the next by a tab.
  <DT>newline<DD>Forces the output to have a single column.
</DL>

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    Column delimiter |
    <A HREF="#appends">Appends</A> |
    <A HREF="#section_header">Section header</A> |
    <A HREF="#single_file">Single file</A> |
    <A HREF="#interleaving">Interleaving</A> |
    <A HREF="#name_format">Name format</A> |
    <A HREF="#output_directory">Directory</A> |
    <A HREF="#output_prefix">Prefix</A> |
    <A HREF="#template">Template</A> |
    <A HREF="#CommandLine">Command line</A>
<HR>

<H2><A NAME="appends">Appends</A></H2>
<P>If the toggle button labeled "Appends" is off, mrc2txt will truncate any
output file that already exists to zero length before mrc2txt writes anything.
If the toggle button labeled "Appends" is on, mrc2txt will write its output
at the end of any output file that already exists.  If an output file does
not already exist, mrc2txt always creates the file regardless of the whether
or not the toggle labeled "Appends" is on.

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    Appends |
    <A HREF="#section_header">Section header</A> |
    <A HREF="#single_file">Single file</A> |
    <A HREF="#interleaving">Interleaving</A> |
    <A HREF="#name_format">Name format</A> |
    <A HREF="#output_directory">Directory</A> |
    <A HREF="#output_prefix">Prefix</A> |
    <A HREF="#template">Template</A> |
    <A HREF="#CommandLine">Command line</A>
<HR>

<H2><A NAME="section_header">Section Header</A></H2>
<P>Use the "Section Header" field to enter text that will be printed,
on a separate line, before the start of each section's data.  If nothing
is entered in the "Section Header" field, then the rows of text for
one section are not separated in any way from the rows of text for the
next section.

<P>When the section header is printed, special conversion codes are expanded.
The conversion codes have the following general form: %[i]<VAR>code</VAR>.
Possible values for <VAR>code</VAR> are:

<DL>
  <DT><STRONG>%</STRONG><DD>Causes a percent sign to be inserted.
  <DT><STRONG>z</STRONG><DD>This conversion code is replaced with the z
    index for the section.
  <DT><STRONG>w</STRONG><DD>This conversion code is replaced with the
    wavelength index for the section.
  <DT><STRONG>t</STRONG><DD>This conversion code is replaced with the time
    point index for the section.
  <DT><STRONG>s</STRONG><DD>This conversion code is replaced with the section
    number for the section.
</DL>

<P>If the i modifier is used with the z, w, t, or s codes then the index
that replaces the conversion code is computed relative to the dimensions of
the input file; otherwise, it is computed relative to the dimensions of
the region selected for conversion.

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    <A HREF="#appends">Appends</A> |
    Section header |
    <A HREF="#single_file">Single file</A> |
    <A HREF="#interleaving">Interleaving</A> |
    <A HREF="#name_format">Name format</A> |
    <A HREF="#output_directory">Directory</A> |
    <A HREF="#output_prefix">Prefix</A> |
    <A HREF="#template">Template</A> |
    <A HREF="#CommandLine">Command line</A>
<HR>

<H2><A NAME="single_file">Single File</A></H2>
<P>The output of Mrc2txt can be a single file with the sections appearing
one after the other or multiple files with one section per file.

<P>To have Mrc2txt generate one output file, turn on the "Single file"
toggle.  The name of the output file can be set with the "Output file" button
or adjacent field.  Use the <A HREF="#interleaving">Interleaving menu</A> to
control how the sections appear within the file.

<P>To have Mrc2txt generate multiple files, turn off the "Single file"
toggle.  The output file names are generated automatically in a variety
of <A HREF="#name_format">formats</A> which can incorporate a
<A HREF="#output_directory">directory name</A>,
<A HREF="#output_prefix">prefix</A>, and the z, wavelength, or time
point indices for the section.

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    <A HREF="#appends">Appends</A> |
    <A HREF="#section_header">Section header</A> |
    Single file |
    <A HREF="#interleaving">Interleaving</A> |
    <A HREF="#name_format">Name format</A> |
    <A HREF="#output_directory">Directory</A> |
    <A HREF="#output_prefix">Prefix</A> |
    <A HREF="#template">Template</A> |
    <A HREF="#CommandLine">Command line</A>
<HR>

<H2><A NAME="interleaving">Interleaving</A></H2>
<P>Interleaving specifies how the z, wavelength, and time point indices map
to the ordering of sections in single file output and how output section
numbers are computed for <A HREF="#template">custom filename templates</A> and
<A HREF="#section_header">section headers</A>.  If the output has
<VAR>nz</VAR> z-sections, <VAR>nw</VAR> wavelengths, and <VAR>nt</VAR> time
points, and a given section has a z-section index in the
output of <VAR>iz</VAR> (0 &lt;= <VAR>iz</VAR> &lt; <VAR>nz</VAR>), wavelength
index in the output of <VAR>iw</VAR> (0 &lt;= <VAR>iw</VAR> &lt;
<VAR>nw</VAR>), and time point index in the output of <VAR>it</VAR> (0 &lt;=
<VAR>it</VAR> &lt; <VAR>nt</VAR>) then the output section number, <VAR>p</VAR>,
(i.e. the position the section will appear when a single file is written) with
the different interleaving options is:

<DL>
  <DT>twz<DD><VAR>it</VAR>+<VAR>nt</VAR>*(<VAR>iw</VAR>+<VAR>nw</VAR>*<VAR>iz</VAR>)
  <DT>tzw<DD><VAR>it</VAR>+<VAR>nt</VAR>*(<VAR>iz</VAR>+<VAR>nz</VAR>*<VAR>iw</VAR>)
  <DT>wtz<DD><VAR>iw</VAR>+<VAR>nw</VAR>*(<VAR>it</VAR>+<VAR>nt</VAR>*<VAR>iz</VAR>)
  <DT>wzt<DD><VAR>iw</VAR>+<VAR>nw</VAR>*(<VAR>iz</VAR>+<VAR>nz</VAR>*<VAR>it</VAR>)
  <DT>ztw<DD><VAR>iz</VAR>+<VAR>nz</VAR>*(<VAR>it</VAR>+<VAR>nt</VAR>*<VAR>iw</VAR>)
  <DT>zwt<DD><VAR>iz</VAR>+<VAR>nz</VAR>*(<VAR>iw</VAR>+<VAR>nw</VAR>*<VAR>it</VAR>)
</DL>

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    <A HREF="#appends">Appends</A> |
    <A HREF="#section_header">Section header</A> |
    <A HREF="#single_file">Single file</A> |
    Interleaving |
    <A HREF="#name_format">Name format</A> |
    <A HREF="#output_directory">Directory</A> |
    <A HREF="#output_prefix">Prefix</A> |
    <A HREF="#template">Template</A> |
    <A HREF="#CommandLine">Command line</A>
<HR>

<H2><A NAME="name_format">Name Format</A></H2>
<P>When multiple files are generated, the file names are generated
by filling in a template.  From the "Name format" menu you may select
a standard template or choose the "custom template" option to use the
template entered in the <A HREF="#template">Template field</A>.  For the
standard templates, the generated file names will all start with the
contents of the <A HREF="#output_directory">Directory field</A>,
followed by a slash, and followed by the contents of the
<A HREF="#output_prefix">Prefix field</A>.  The remainder of the
file name depends on which template was chosen:  it will be the template
name ("prefix_w#_z#_t#.txt", for instance) without the leading "prefix"
and with "w#" replaced with a w followed by the output wave index for the
section in the file, "t#" replaced with a t followed by the output time index
for the section in the file, and "z#" replaced with a z followed by the
output z index for the section in the file.  The numbers of digits used for
an index is the digits needed to represent the largest index in that dimension.
As an example, with the "prefix_w#_z#_t#.txt" template, /var/tmp as the
output directory, exp12_2002 as the output prefix, and an input region that
has 3 wavelengths, 500 time points, and 30 z sections, the file name for the
section whose output z, wavelength, and time indices are 1, 2, and 3
respectively would be /var/tmp/exp12_2002_w2_z01_t003.txt.

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    <A HREF="#appends">Appends</A> |
    <A HREF="#section_header">Section header</A> |
    <A HREF="#single_file">Single file</A> |
    <A HREF="#interleaving">Interleaving</A> |
    Name format |
    <A HREF="#output_directory">Directory</A> |
    <A HREF="#output_prefix">Prefix</A> |
    <A HREF="#template">Template</A> |
    <A HREF="#CommandLine">Command line</A>
<HR>

<H2><A NAME="output_directory">Directory</A></H2>
<P>When multiple files are written and one of the
<A HREF="#name_format">standard file name formats</A> is used, the generated
file names will start with the contents of the Directory field.
The <A HREF="#name_format">section on name formats</A> has an example of this.
For a custom template, the contents of the Directory field are
substituted for any %d conversion codes.

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    <A HREF="#appends">Appends</A> |
    <A HREF="#section_header">Section header</A> |
    <A HREF="#single_file">Single file</A> |
    <A HREF="#interleaving">Interleaving</A> |
    <A HREF="#name_format">Name format</A> |
    Directory |
    <A HREF="#output_prefix">Prefix</A> |
    <A HREF="#template">Template</A> |
    <A HREF="#CommandLine">Command line</A>
<HR>

<H2><A NAME="output_prefix">Prefix</A></H2>
<P>When multiple files are written and one of the
<A HREF="#name_format">standard file name formats</A> is used, the generated
file names will include the contents of the Prefix field.
The <A HREF="#name_format">section on name formats</A> has an example of this.
For a custom template, the contents of the Prefix field are
substituted for any %p conversion codes.

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    <A HREF="#appends">Appends</A> |
    <A HREF="#section_header">Section header</A> |
    <A HREF="#single_file">Single file</A> |
    <A HREF="#interleaving">Interleaving</A> |
    <A HREF="#name_format">Name format</A> |
    <A HREF="#output_directory">Directory</A> |
    Prefix |
    <A HREF="#template">Template</A> |
    <A HREF="#CommandLine">Command line</A>
<HR>

<H2><A NAME="template">Template</A></H2>
<P>The file name generation mechanism for multiple output files may use
a custom file name template.  To do so select "custom template" from the
<A HREF="#name_format">"Name format" menu</A> and enter the template in
the Template field.  When generating file names, special conversion
codes are expanded in the template.  The conversion codes have the following
general form: %[<VAR>width</VAR>][<VAR>modifier</VAR>]<VAR>code</VAR>.

<P>The recognized codes are:
<DL>
  <DT><STRONG>%</STRONG><DD>Causes a percent sign to be inserted in the
    file name.
  <DT><STRONG>d</STRONG><DD>This conversion code is replaced with the
    contents of the <A HREF="#output_directory">Directory field</A>.
  <DT><STRONG>p</STRONG><DD>This conversion code is replaced with the
    contents of the <A HREF="#output_prefix">Prefix field</A>.
  <DT><STRONG>z</STRONG><DD>This conversion code is replaced with the z
    index for the section stored in the file.
  <DT><STRONG>w</STRONG><DD>This conversion code is replaced with the
    wavelength index for the section stored in the file.
  <DT><STRONG>t</STRONG><DD>This conversion code is replaced with the time
    point index for the section stored in the file.
  <DT><STRONG>s</STRONG><DD>This conversion code is replaced with the section
    number for the section stored in the file.
</DL>

<P><VAR>width</VAR> is optional and may be used with the <STRONG>z</STRONG>,
<STRONG>w</STRONG>, <STRONG>t</STRONG>, and <STRONG>s</STRONG> codes to
specify the minimum number of digits which are used to display the index value.
<VAR>width</VAR> may be a positive integer indicating the minimum number of
digits to use or the letter a to indicate that the minimum number of digits
should be the number of digits in the maximum corresponding index.  If an
index would have less than the minimum number of digits, leading zeros are
added to fill in the missing portion.

<P><VAR>modifier</VAR> is optional and may be used with the <STRONG>z</STRONG>,
<STRONG>w</STRONG>, <STRONG>t</STRONG>, and <STRONG>s</STRONG> codes.  If
<VAR>modifier</VAR> is not present, the index generated by those codes is
computed for the output file.  If <VAR>modifier</VAR> is the letter i, then
the index is computed relative to the input file.

<P>As an example, the <A HREF="#name_format">standard name format</A>,
"prefix_w#_z#_t#.txt", is equivalent to the custom template,
%d/%p_w%aw_z%az_t%at.txt.  The custom template, /var/tmp/%2iz_%2iw_%2it.txt,
would generate file names which included the input z, wavelength, and time
indices of the section in the file.  Each index would be displayed with at
least two digits.

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    <A HREF="#appends">Appends</A> |
    <A HREF="#section_header">Section header</A> |
    <A HREF="#single_file">Single file</A> |
    <A HREF="#interleaving">Interleaving</A> |
    <A HREF="#name_format">Name format</A> |
    <A HREF="#output_directory">Directory</A> |
    <A HREF="#output_prefix">Prefix</A> |
    Template |
    <A HREF="#CommandLine">Command line</A>
<HR>

<H2><A NAME="CommandLine">Command Line</A></H2>
<P>mrc2txt accepts the command-line arguments described in
<A HREF="Region.html#COMMANDLINE">Region.html</A>.  In addition, it has
the following options (parts in brackets are optional):

<DL>
  <DT><CODE>-append</CODE>
  <DD>If present and an output file already exists, mrc2txt will append its
    output to the file.  If not present and an output file already exists,
    mrc2txt will truncate the file to zero length before writing its output.
    When an output file does not already exist, this option has no effect:
    mrc2txt will always create the file.

  <DT><CODE>-delimiter=</CODE><VAR>delim</VAR>
  <DD>Sets how columns are separated in the output file.  <VAR>delim</VAR>
    can be either space, tab, or newline.  By default, mrc2txt uses tabs.

  <DT><CODE>-dir=</CODE><VAR>dir</VAR>
  <DD>Sets the name of the directory to use in the file name template when
    mrc2txt generates multiple output files from the input file.
    If you use the -single option to force mrc2txt to generate one output
    file, the -dir option has no effect.  By default, the directory name is
    an empty string.

  <DT><CODE>-header=</CODE><VAR>template</VAR>
  <DD>Sets the <A HREF="#section_header">template for the text</A> mrc2txt
    prints before the data for each section.  By default, mrc2txt does not
    print anything to introduce the data for a section.

  <DT><CODE>-interleave=</CODE><VAR>arrangement</VAR>
  <DD>Sets the <A HREF="#interleaving">interleaving</A> to use when writing
    multiple sections to a single text file or for calculating output section
    indices for custom file name templates.  Allowed values for
    <VAR>arrangement</VAR> are twz, tzw, wtz, wzt, ztw, or zwt; ztw is the
    default.

  <DT><CODE>-out=</CODE><VAR>name</VAR> or <CODE>-out=</CODE><VAR>name_format</VAR>
  <DD>If you use the -single option, use -out to set the name of the file
    to generate.  If you do not use the -single option, you can use -out
    to select one of the predefined output file name templates.  The
    allowed values for <VAR>name_format</VAR> when you do not use the
    -single option are:
    <DL>
      <DT>prefix+wzt<DD>Causes mrc2txt to generate output file names as if
        <A HREF="#name_format">"prefix_w#_z#_t#.txt"</A> had been selected from
        the user interface.  This is the default.
      <DT>prefix+wz<DD>Causes mrc2txt to generate output file names as if
        <A HREF="#name_format">"prefix_w#_z#.txt"</A> had been selected from
        the user interface.
      <DT>prefix+wt<DD>Causes mrc2txt to generate output file names as if
        <A HREF="#name_format">"prefix_w#_t#.txt"</A> had been selected from
        the user interface.
      <DT>prefix+zt<DD>Causes mrc2txt to generate output file names as if
        <A HREF="#name_format">"prefix_z#_t#.txt"</A> had been selected from
        the user interface.
      <DT>prefix+w<DD>Causes mrc2txt to generate output file names as if
        <A HREF="#name_format">"prefix_w#.txt"</A> had been selected from
        the user interface.
      <DT>prefix+z<DD>Causes mrc2txt to generate output file names as if
        <A HREF="#name_format">"prefix_z#.txt"</A> had been selected from
        the user interface.
      <DT>prefix+t<DD>Causes mrc2txt to generate output file names as if
        <A HREF="#name_format">"prefix_t#.txt"</A> had been selected from
        the user interface.
    </DL>
    When you do not use the -single option, the -template option will
    override the -out option.

  <DT><CODE>-prefix=</CODE><VAR>pref</VAR>
  <DD>Sets the prefix to use in the file name template when mrc2txt generates
    multiple output files from the input file.  If you use the -single option
    to force mrc2txt to generate one output file, the -prefix option has no
    effect.  By default, the prefix is an empty string.

  <DT><CODE>-single</CODE>
  <DD>If you use this option, mrc2txt will generate a single output file
    (whose name is controlled by the -out option).  If you do not use this
    option, mrc2txt will generate one file for each section drawn from the
    input file.

  <DT><CODE>-template=</CODE><VAR>custom_template</VAR>
  <DD>Sets the <A HREF="#template">file name template</A> mrc2txt will
    use when generating one file per section in the MRC file.  This option has
    no effect if you use the -single option and overrides the -out option when
    you do not use the -single option.  By default, the template is an empty
    string.
</DL>

<P>The following example saves the tenth z section from the first
wavelength of fish.dat in section.txt.

<PRE>
    mrc2txt fish.dat -z=9:9 -w=0 -single -out=section.txt
</PRE>

<H3>Topics</H3>
<P>
    <A HREF="#mrc2txt">Overview</A> |
    <A HREF="Region.html">Region processing</A> |
    <A HREF="#column_delimiter">Column delimiter</A> |
    <A HREF="#appends">Appends</A> |
    <A HREF="#section_header">Section header</A> |
    <A HREF="#single_file">Single file</A> |
    <A HREF="#interleaving">Interleaving</A> |
    <A HREF="#name_format">Name format</A> |
    <A HREF="#output_directory">Directory</A> |
    <A HREF="#output_prefix">Prefix</A> |
    <A HREF="#template">Template</A> |
    Command line
<HR>

</BODY>
</HTML>
