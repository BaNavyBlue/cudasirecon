<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
  <META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <TITLE>Priism Help: PEdit</TITLE>
  <META NAME="Description" CONTENT="On-line help for the point list editor used with the EM alignment package.">
  <META NAME="Keywords" CONTENT="Priism,EM,tomography,alignment,gold beads">
  <LINK REV=MADE HREF="mailto:ive@msg.ucsf.edu">
</HEAD>
<BODY>

<H1><A NAME="PEdit">PEdit</A></H1>
<H2>Overview</H2>
<P> PEdit is a general purpose point editing program.  It adds and
deletes points overlaid onto a stack of images interactively
(correction of a point is achieved by the coupled actions of
adding/deletion).  There are two classes of point lists PEdit can edit:
<UL>
<LI>Matched point list: Any point P(ib,iv) is indexed by two
parameters, i.e., the section iv it belongs to and the labeled number
ib in that section.  Examples are the matched bead list generated from
<A HREF="BEAD_MATCHER.html">BEAD_MATCHER</A> or
<A HREF="BEAD_CHASER.html">BEAD_CHASER</A>, with each bead ib being traced
through projections of different view angles.  Note that not all P(ib,iv) are
available.
<LI>Unmatched point list: a sub-list of points Pi(iv) belong to a
section iv, but there is no inter-section indexing.  An example is the
list bead-like features generated from
<A HREF="BEAD_FINDER.html">BEAD_FINDER</A>.
</UL>

<P>In the case where a point list could not be loaded or you cleared the
current point list, PEdit creates an empty list.  If you select points in
the image window, that empty list becomes an unmatched point list.  To
force the empty list to become a matched point list, enter a non-zero
in the field for the matched number of points.

<P>Instead of providing the file names for the the graphical interface,
the file names and average bead radius can be provided as command
line arguments.  The command line syntax is:
<P><CODE>PEdit</CODE> <VAR>IdatFile</VAR> <VAR>IplFile</VAR> <VAR>OplFile</VAR> <VAR>bead_radius</VAR>
<P>If you do want to provide one of the files on the command line but want to
specify one of the arguments that appears after it, use a name with just one
letter since filenames with one letter are ignored.

<H3><A NAME="Topics">Topics</A></H3>
<P>
   <A HREF="#IdatFile">IdatFile</A> |
   <A HREF="#IplFile">IplFile</A> |
   <A HREF="#OplFile">OplFile</A> |
   <A HREF="#InteractiveEditing">Interactive Editing</A> |
   <A HREF="#NX:NY:NV">NX:NY:NV</A> |
   <A HREF="#Point_List">Point List</A> |
   <A HREF="#Display">Display</A> |
   <A HREF="#Color">Color</A> |
   <A HREF="#(x-c)_peak">(x-c) Peak</A> |
   <A HREF="#Min_Peak">Min Peak</A> |
   <A HREF="#Section">Section</A> |
   <A HREF="#&lt;-_-&gt;">&lt;-_-&gt;</A> |
   <A HREF="#MatchedPointCount">Matched Point Count</A> |
   <A HREF="#CurrentPoint">Current Point</A> |
   <A HREF="#Merge">Merge</A> |
   <A HREF="#Save">Save</A> |
   <A HREF="#ClearAll">Clear All</A> |
   <A HREF="#Exit">Exit</A>


<H3>Related Priism Topics</H3>
<P>
   <A HREF="../Priism.html">Priism</A> |
   <A HREF="BALIGN.html">Alignment</A> |

<HR>

<H2><A NAME="IdatFile">IdatFile</A></H2>
<P>IdatFile is the image data stack.  When the file name is selected
(either through command line or from widget), you will be prompted to
load this file into a image window if it is not already displayed.
After loading it, you will also need to register to its loaded window by
pressing the <A HREF="#Display">Display button</A> to start displaying and
editing the point list.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>
 
<H2><A NAME="IplFile">IplFile</A></H2>
<P>IplFile is the input point list file.  When the file name is entered
(either from the command line or through the graphical interface):
<UL>
  <LI>Read in a point list in an existing file to a image window. Then
    you need to display and start editing the point list by pressing
    the <A HREF="#Display">Display button</A>.
  <LI>If the data set is already loaded in an image window, you can
    immediately start changing the bead list in that image window.
    The "Window" field shows the number of the image window to use.
  <LI>If IplFile has a name of one letter long, PEdit will create a
    new empty list; for a more intuitive way to do the same thing,
    use the <A HREF="#ClearAll">"Clear All" button</A>.
</UL>

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>
 
<H2><A NAME="OplFile">OplFile</A></H2>
<P>OplFile is the output point list file.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="InteractiveEditing">Interactive Editing</A></H2>
<P>When the "Interactive Editing" toggle is off, PEdit only displays the
point list and does not allow selection of points in the image window.  This
is useful when you want another application (including another instance
of PEdit) to respond to the interaction of the mouse with the image window.

<P>The interactive editing that PEdit allows on an unmatched list is:
<UL>
  <LI>Using the left mouse button to click on the image at or near a point
    that is already marked deletes that point.
  <LI>Using the left mouse button to click on the image away from a point that
    is already marked adds a new point.
</UL>

<P>The interactive editing that PEdit allows on a matched list is:
<UL>
  <LI>If no point is currently selected (the words "Select point" are
    displayed in the upper right corner of the image display area and the
    <A HREF="#CurrentPoint">"Current Point" field</A> in PEdit's dialog
    is zero), using the left mouse button to click on or near a point
    makes that point the selected point.
  <LI>If a point is currently selected (the point number is displayed in
    the upper right corner of the image display area followed by the total
    number of beads and an indication whether or not that point has been
    assigned a position in this section; the point number is also shown
    in the <A HREF="#CurrentPoint">"Current Point" field</A>), using the
    left mouse button to click on the image moves the currently selected point
    to that location.  Using the left mouse button to click between the
    edge of the image and the boundaries of the image display area causes
    the currently selected point to not have an assigned position for the
    section.
  <LI>While the mouse pointer is over the image, pressing the "n" key
    increases the currently selected point number by one; if the currently
    selected point is the last point, sets the currently selected point to
    be the first point.
  <LI>While the mouse pointer is over the image, pressing the "p" key
    decreases the currently selected point number by one; if the currently
    selected point is the first point, sets the currently selected point to
    be the last point.
  <LI>While the mouse pointer is over the image and a point is currently
    selected, pressing the "r" key causes the point to not have an assigned
    position for the section.
</UL>

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="NX:NY:NV">NX:NY:NV</A></H2>
<P>The first two values in this field are the x and y dimensions of the
data set specified by <A HREF="#IdatFile">IdatFile</A>.  The third value
is the number of sections in that file.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="Point_List">Point List</A></H2>
<P>This field shows whether IplFile is a unmatched point list (simply
a list of the points on each section), a matched point list where
points on different sections have been identified as belonging to the
same feature, or an empty point list.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="Display">Display</A></H2>
<P>When the Display toggle is on, the point list is displayed as an overlay
in the window whose number is the first value shown in the Window
field.  By changing the number in this field, you can display the point list
in a different window (alternatively you can select a new IdatFile).

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="Color">Color</A></H2>
<P>Use this pulldown to select the color which is used when the point list
is displayed.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="(x-c)_peak">(x-c) Peak</A></H2>
<P>When editing a point list, you select point positions in an image window
by moving the cursor to them and clicking the left mouse button.  When the
<EM>(x-c) Peak</EM> toggle is off, the selected position is used without
modification.  When the toggle is on, a search in the vicinity of the
selected point is done for the actual point to use.  One of two criteria
is used for that search:

<UL>
  <LI>If the bead radius shown in the menu is greater than one, the
    search is performed on the cross-correlation of the image data and
    a model circular bead with the bead radius specified in the menu.
    The peak of the cross-correlation within two bead radii of the
    selected point is found, and a three point polynomial interpolation
    of the cross-correlation values with respect to x and y is done
    to obtain the coordinates of the point used. The left pulldown widget
    provides the option of minimum or maximum peak searching.
  <LI>If the bead radius is less than or equal to one, the search is
    for a peak in the image data within six pixels of the selected point.
</UL>

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="Min_Peak">Min Peak</A></H2>
<P>Use this pulldown to select whether or a minimum peak or maximum peak
search is performed then the <A HREF="#(x-c)_peak">(x-c) Peak toggle</A>
is on.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="Section">Section</A></H2>
<P>The Section toggle button and controls on the same line are only
enabled for unmatched lists.  When the Section toggle button is on, the
three numbers in the adjacent field set the range and increment for the set of
sections saved to OplFile.  This is useful when
<A HREF="#Merge">merging new points</A> with an existing list since the merge
option uses the sections selected here to decide which points are taken from
the old list and which points are taken from the new.  When the Section toggle
is off, points on all sections are saved to the Oplfile.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="&lt;-_-&gt;">&lt;-_-&gt;</A></H2>
<P>Press the left button to display the previous section (as
set by the <A HREF="#Section">section field</A>); press the right
button to display the next section.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="MatchedPointCount">Matched Point Count</A></H2>
<P>The "Matched Point Count" field is only enabled for matched lists.  For
a matched list, PEdit displays the number of points per section in the
"Matched Point Count" field.  You can change the number of points per section
by editing the value.  When increased, PEdit will add the appropriate number
of unassigned points to each section (currently PEdit allows a maximum of
50 points per section because of limitations in what Bead Chaser and Bead Align
can handle).  If decreased, PEdit will delete the highest numbered points so
the count matches what was entered.  Setting the number of points to zero has
the same affect as pressing the <A HREF="#ClearAll">"Clear All" button</A> but
does not check for unsaved changes.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="CurrentPoint">Current Point</A></H2>
<P>The "Current Point" field is only enabled for matched lists.  When
working with a matched list, PEdit will display the number of the currently
selected point in the "Current Point" field or will put a zero there if
no point is currently selected.  Which point is current is important
while <A HREF="#InteractiveEditing">interactively editing</A> the list;
you can change the value shown in the "Current Point" field to select a
new current point.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="Merge">Merge</A></H2>
<P>The Merge toggle button is only enabled when the list is an unmatched list.
If the Merge toggle is on and you save the list, PEdit will save
the points belonging to the selected sections to the new OplFile (that
has the same name as the existing OplFile), it will also check the
point list in the existing OplFile to see if it has points on sections
other than the selected ones.  If it does, PEdit will save these points as
well to the new OplFile.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="Save">Save</A></H2>
<P>Use this button to save the point list to <A HREF="#OplFile">OplFile</A>.
The existing OplFile will be merged with the point list if the
<A HREF="#Merge">merge toggle</A> is on.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

<H2><A NAME="ClearAll">Clear All</A></H2>
<P>Pressing the "Clear All" button will remove the current point selections
from memory (if changes have been made you will be asked whether or not to
continue) and create an empty list.  If you want the empty list to be an
unmatched list, start selecting point positions in the image window.  If you
want the empty list to be a matched list, first set the the number of points
in the list with the
<A HREF="#MatchedPointCount">"Matched Point Count" field</A> and then edit the
positions of the new points.

<H2><A NAME="Exit">Exit</A></H2>
<P>Use this button to quit PEdit.  If there has been any change in the
point list, you will be prompted to save the point list before the program
exits.

<P><A HREF="#Topics">Return to the list of topics</A>
<HR>

</BODY>
</HTML>
