<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
  <META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <TITLE>Recent Changes in IVE/Priism</TITLE>
  <META NAME="Description" CONTENT="Summarizes changes made recently to IVE/Priism.">
  <META NAME="Keywords" CONTENT="Priism,IVE,changes">
  <LINK REV=MADE HREF="mailto:ive@msg.ucsf.edu">
</HEAD>
<BODY>

<H1><A NAME="RecentChanges">Recent Changes In IVE/Priism</A></H1>
<H2>Overview</H2>
<P>Changes are broken down by the version in which they were incorporated.
Recent releases are listed below, for older releases consult
<A HREF="OlderChanges.html">OlderChanges.html</A>

<OL>
  <LI><A HREF="#IVE4.4.1">IVE 4.4.1</A> (November 13, 2014)
  <LI><A HREF="#IVE4.4.0">IVE 4.4.0</A> (October 27, 2014)
  <LI><A HREF="#IVE4.3.0">IVE 4.3.0</A> (February 19, 2013)
  <LI><A HREF="#IVE4.2.9">IVE 4.2.9</A> (May 16, 2011)
  <LI><A HREF="#IVE4.2.8">IVE 4.2.8</A> (December 7, 2010)
  <LI><A HREF="#IVE4.2.7">IVE 4.2.7</A> (May 11, 2010)
  <LI><A HREF="#IVE4.2.6">IVE 4.2.6</A> (October 12, 2009)
  <LI><A HREF="#IVE4.2.5">IVE 4.2.5</A> (July 18, 2008)
  <LI><A HREF="#IVE4.2.4">IVE 4.2.4</A> (May 6, 2008)
  <LI><A HREF="#IVE4.2.3">IVE 4.2.3</A> (November 12, 2007)
  <LI><A HREF="#IVE4.2.2">IVE 4.2.2</A> (August 21, 2006)
  <LI><A HREF="#IVE4.2.1">IVE 4.2.1</A> (December 20, 2005)
  <LI><A HREF="#IVE4.2.0">IVE 4.2.0</A> (September 20, 2004)
</OL>

<H3>Related Priism Topics</H3>
<P>
  <A HREF="Priism.html">Priism</A> |
  <A HREF="Limitations.html">Known problems</A> |
  <A HREF="BugReport.html">Reporting problems</A> |
  <A HREF="http://msg.ucsf.edu/IVE/Download/index.html">Priism download site</A>
<HR>

<H2><A NAME="IVE4.4.1">IVE 4.4.1</A></H2>
<P>Problems fixed in 4.4.1 are:
<UL>
  <LI>With the ER-Decon II application and the new line search, the application
    would crash after deconvolving the first volume if you did not use an
    output plot file.
  <LI>The ER-Decon I and ER-Decon II applications did not handle time steps
    different than one correctly.
  <LI>The ER-Decon II application enforced a check on the numerical aperture
    and refractive index when those parameters were not used and did not
    check those parameters when they were used.
</UL>

<H2><A NAME="IVE4.4.0">IVE 4.4.0</A></H2>
<P>Features added in 4.4.0 are:
<UL>
  <LI>Modified to natively handle the Image2000 format (there's one exception:
    Priism still uses mode 0 for unsigned 8-bit data; in Image2000 mode 0 is
    for signed 8-bit data).  Modified CopyRegion to allow the user to change
    the byte order or header format of the copied data.
  <LI>Added an application for correction of some defects noted in images
    from Gatan's K2 camera.
  <LI>Added log file output for the TALIGN shifts during iterative alignment.
  <LI>Modified the ER-Decon II application to incorporate an updated line
    search algorithm and to expose what was an internally hardwired parameter
    (but by default set the parameter to zero since that matches the 2013
    PNAS paper).  Parallelized more of the code in the ER-Decon II application.
  <LI>Modified DisplayAttr so more of an image windows attributes can be
    modified through its interface.  Added a command-line interface to
    DisplayAttr so those attributes can also be set from the command line.
    Added a command-line interface to SelectImgColors so an image window's
    wavelength colors can be set from the command line.
  <LI>Modified tiff2mrc to allow extracting a subset of images from a file
    with multiple images and to allow for different interpretations of the
    page numbers in a file with multiple images.
  <LI>Added operations in Image Arithmetic to take the natural logarithm of
    the pixel values or to raise them to fixed exponent.
  <LI>Added a command line interface for RadProj.
  <LI>Added an option to mrc2txt to append when writing.
  <LI>Increased the upper limits on the number of elements in a segmented
    volume for Watershed (previously was 2^31-1; now is 2^32-1 for 32-bit
    systems and 2^64-1 for 64-bit systems).
  <LI>For batch-mode applications, write the host used to the log file.
  <LI>Added IWXEvtToDataExt() to better work with image windows that display
    multiple images.
  <LI>Added IWRtSecNumColor(), IWAlSecNumColor(), IWRtSecNumDisplay(), and
    IWAlSecNumDisplay() to control the section number labels drawn on images
    in an image window.  Added IWRtDisResLevel() and IWAlDisResLevel() to
    control the currently displayed resolution level in an image window.
  <LI>Added support for files with 4-bit unsigned values.  As part of that,
    added IWRtPixSizeExt().
</UL>

<P>Problems fixed in 4.4.0 are:
<UL>
  <LI>In the Alignment and Reconstruction user interface, corrected two cases
    where the input parameter file was not correctly propagated (tilt axis
    determination with rough alignment and no mass-normalization and CTF
    correction when at least one of the parameter-generating applications
    before it is on).  Corrected the propagation of the resolution level when
    using CTF correction.  Corrected how the Wiener factor for the CTF
    correction is written to the job script.  Corrected some cases where the
    displayed state for the input alignment parameter toggle buttons in the
    massnorm, tilt axis determination, and CTF correction dialogs did not
    match the internal state.
  <LI>In version 4.3.0, the iterative EM alignment applications could stop
    after the first iteration because the alignment parameter file from the
    first iteration was written with an extra line in some cases.
  <LI>Modified massnorm and align_2d_p to recognize data with 50 floating-point
    entries per image in the extended header (such data is generated by the
    drift-correction software for K2 data).
  <LI>The cross-correlation images from the alignment in the iterative
    alignment are no longer garbled if working with a lower resolution of the
    input data.
  <LI>In the GPU reconstruction server, the 64-bit version would incorrectly
    flag GPUs as busy in some cases.  Replaced the 32-bit version with one
    compiled against CUDA 3.1.9 since the one compiled against CUDA 5.0.7 did
    not work correctly.
  <LI>Corrected the parallel versions of the EWBP and TAPIR reconstructions
    and projection alignment so that output with a relative path is computed
    relative to the working directory at startup rather than the temporary
    directory.  Corrected the parallel alignment so it does not attempt to
    assemble cross-correlation images if the alignment method does not use
    TALIGN.
  <LI>gpurecon would spuriously reject certain y bounds when working at a
    lower resolution.
  <LI>gpureproj would mistakenly require the -rscale option.
  <LI>The graphical interfaces for the GPU versions of the iterative EM
    alignment applications did not pass the requested number of processors to
    the queueing system in all cases.
  <LI>Removed the internal limit of 6000 bead positions in the graphical
    display for the final stage of the bead alignment.  Now embed that display
    in a scrolled window so the size of the histogram bars does not vary with
    the number of tilts or beads.  Corrected cleanup code in the graphical
    display for the final stage of the bead alignment.
  <LI>In the EM applications, appending resolutions to an output could fail
    if the output file name contained characters with special meaning to the
    shell.
  <LI>In EditHeader2 and mrc2image2000, modified to use the machine stamp as
    defined in the CCP4 documentation.
  <LI>Image Arithmetic incorrectly rejected -clamp as an invalid command-line
    option.  The handling of zero-clamping for the phase operation did not
    match the documentation (i.e. that zero-clamping is only applied if the
    output file does not store the data as complex).
  <LI>For real-valued input, RadProj now will report phases of pi for
    negative values rather than phases of zero.
  <LI>Corrected Line Profile to avoid crashes when saving results.
  <LI>Merge/Reorder now resets the z origin in the header to zero.
  <LI>In mrcpercentiles, now represent cutoffs internally with a double
    precision value (for larger data sets may want fractions close to one that
    a single precision value can not accurately represent).  Modified to
    correctly handle cases where the cutoff is one.
  <LI>Corrected Point Values to report the correct information when working
    with image windows that display multiple images and either the layout
    is not the data layout or the image stepping is not along the z dimension.
  <LI>In Region Growing, corrected how the scaling and minimum and maximum
    values in the header are set when no points are selected by the region
    growing.
  <LI>In View File, corrected array overflow if working with input that has
    more than three wavelengths.
  <LI>In Watershed, protected against overflow in the computation of the
    maximum number of patches.  Corrected use of uninitialized memory when
    saving intensity-weighted patch centers.  Removed a memory leak when
    reassigning patch tags fails.
  <LI>Package with libquicktime 1.2.4 linked against libpng 1.2.50.  The
    version included with 4.3.0 would generate a runtime error when using PNG
    as the codec.
  <LI>In the post-installation setup, use "." rather than "source" in case
    /bin/sh is not bash.
  <LI>Clear the image window when changing wavelengths in pseudocolor mode
    and the wavelengths have different spatial offsets when displayed.
  <LI>Corrected cases where writing a large data set to an image window,
    appending resolutions to that data, and then appending more data would
    cause the image window to crash.
  <LI>Corrected regression in 4.3.0: IWRtWid() would return -1 rather than 0
    when the stream is not attached to an image window.
  <LI>Corrected IMTrHdr() to only transfer the extended header if its size is
    positive (previously would do so if the size was different than zero).
  <LI>Corrected IMWrHdr() for the case where the number of labels is the
    largest 32-bit signed integer.
</UL>

<P>Other changes in 4.4.0 are:
<UL>
  <LI>By default, image files are written in the machine's native byte order.
    Previously, the default was to write files in big-endian order.
  <LI>No longer supply binaries for PowerPC-based Macs.
</UL>

<H2><A NAME="IVE4.3.0">IVE 4.3.0</A></H2>
<P>Features added in 4.3.0 are:
<UL>
  <LI>Added <A HREF="mrcpercentiles.html">DataViews-&gt;DataInfo-&gt;Percentiles</A>
    for determining the intensity cutoff values that correspond to different
    fractions of the total number of elements in the data set.
  <LI>Made the gpu-accelerated versions of the EM processing applications
    available in all versions.
  <LI>Added a step in the EM processing to
    <A HREF="EMCAT/PFOCUSRAMP.html">apply CTF correction</A>.  The application
    is based on David Agard's focusramp4.  To accommodate the geometry
    conventions used by the CTF correction, added options in other EM
    applications to reverse the orientation of the tilt axis.
  <LI>Replaced Processing-&gt;EM Processing-&gt;CTF Plot with
    <A HREF="EMCAT/emctfvis.html">Processing-&gt;EM Processing-&gt;CTF Visualization</A>.
    It can generate images, plots, or text tables of the CTF values.
  <LI>Modified the parallel EM applications to be able to work with OpenMPI.
    Also modified them and other parallel applications to respect the NSLOTS
    environment variable for better integration with the GridEngine queueing
    system.  As a side effect, the queue configuration file, queues.def, and
    the queue integration in the iomenu library have changed in non-backwardly
    compatible ways.
  <LI>RunProj can now compute projections along the x, y, or z axes.
  <LI>Watershed will now apply a histogram sort to unsigned short data rather
    than a slower heap sort after conversion to floating-point.
  <LI>Added an option in bead alignment for EM tomography to fix the alignment
    parameters while allowing the fit bead positions to vary.
  <LI>Treat a coverage of zero in a particular direction as no tapering in
    that direction for the various applications in the "Fourier Tools" menu.
  <LI>To simplify use of the archive libraries for MRC file I/O, those
    libraries no longer depend on C++ libraries.  Added implementations of the
    MRC file I/O libraries for Windows.
  <LI>In the iomenu library, added options to display a subset of the region
    selection controls.
  <LI>Added an implementation of the IM library for Windows.
  <LI>(UCSF version only) In the deconvolution applications, added an option
    to skip rescaling of the transfer function.  Also added the option to
    generate a separate file with the R-factor or termination criteria results.
  <LI>(Internal version only) Added an <A HREF="core2_decon.html">implementation of Muthuvel Arigovindan's ER-Decon II deconvolution algorithm</A>.
    It was designed for 3D widefield data.  It also has the option to process
    2D data.
</UL>

<P>Problems fixed in 4.3.0 are:
<UL>
  <LI>For x86_64 Linux systems, removed the restriction that limited the
    shared memory file to be less than 4 gigabytes in size.  The change
    breaks binary compatibility for some x86_64 Linux applications.  If you
    have your own applications that interact with Priism's image windows, you
    may have to recompile them.  The
    <A HREF="IM_ref2.html#ReleaseNotes">IM library release notes</A> has
    more details on the kinds of applications that are affected.
  <LI>Priism's setup script would not recognize at least some systems as
    64-bit capable under Mac OS X 10.7 or later.
  <LI>No longer depend on libXp since newer versions of X11 do not include it
    at all (and older versions did not include it by default).
  <LI>Redirect standard input, output, and error when running Priism from
    Priism.command to avoid problems with applications launched from Priism.
  <LI>To match the Welch method for estimating power spectra, corrected the
    power spectrum applications to average the spectra before taking the
    square root:  previous versions took the square root and then averaged.
    Also apply the power reduction factor due to the tapering window before
    taking the square root rather than afterwards.
  <LI>The machine stamp written by mrc2ccp4 is now in agreement with the
    the values in the CCP4 documentation.
  <LI>When "Show Point Info" is pressed in Find Points, the displayed dialog
    now automatically jumps to the start of the point list.
  <LI>For wavelengths after the first, Region Min/Max/Mean displayed incorrect
    wavelength values in its main dialog.
  <LI>The output size computation in Rotate3D can no longer trigger an infinite
    loop if one or more of the input sizes is not positive.
  <LI>There was a buffer overflow in the interactive bead alignment if the
    path name for the directory where the application was started was longer
    than 99 characters.
  <LI>In the background fit option, massnorm did not count the portion of the
    points in the highest histogram bin.
  <LI>Corrected handling of nonzero values for -res and -resref in the
    alignment portion of the applications to iteratively align EM tomography
    data.  Also accept the documented -fullsize option rather than ignoring it.
  <LI>Restructured the internal help viewer:  it was crashing when "up a level"
    was pushed for a file in the top-level help directory.
  <LI>Corrected applications that use the 2D processing from the IP framework
    so that closing an output window during processing does not trigger an
    infinite loop when the application finishes the processing.
  <LI>In the I/O handling for MRC files, removed the infinite loop if attempts
    to open a file are repeatedly interrupted by the operating system.
  <LI>Added IWRetBaseDirectoryExt() and IWRetSHMDirectoryExt() as replacements
    for IWRetBaseDirectory() and IWRetSHMDirectory().  In the libraries and
    applications, made modifications to avoid buffer overflows if those
    directory names, or other values from the environment, are too long.
  <LI>Corrected the effect of turning off image buffering with IWAlBufImg() on
    an image windows that had already swapped out scaled images or data.
    Corrected the return value of IWRtBufImg():  previous versions included
    status bits tracked internally.
  <LI>Modified the 64-bit version of OS X to use the stat64() family of calls
    in case files with 64-bit inode values are encountered.  In all versions,
    replaced instances where the stat() family were always used with code
    that uses stat() or stat64() as appropriate for the platform.
  <LI>Modified the OS X version so that semaphores created with
    IVEShmInitSemaphore() have internal names that are unique across Priism
    sessions running simultaneously.  This changes the shared memory file
    format and introduces compatibility issues with statically linked
    applications from different Priism versions.
  <LI>(Internal version only) Now use zero padding in x and y for ER-Decon I
    rather than linear interpolation between the edges.
</UL>

<P>Other changes in 4.3.0 are:
<UL>
  <LI>Now use FFTW 3.3.3 for all versions.  The FFTW 2 libraries for PowerPC
    Mac OS X and 32-bit Linux are still included but may be removed in a future
    release.
  <LI>In RadProj, plots and text output now use the lower bound for the bin
    as the coordinate rather than the center of the bin.
  <LI>In the EM alignment applications, the characteristic lengths for angular
    parameters now use units of degrees rather than radians.
  <LI>In the tilt axis determination for EM, changed the special value that
    centers the search range on the tilt axis orientation for the first image:
    the new special value is -180 rather than -90.
  <LI>In the alignment portion of applications to iteratively align EM
    tomography data, -nooffset is now the default and the initial value for the
    stretch axis is perpendicular to the tilt axis.
  <LI>Added documentation for FTransform2D, FTransform3D, and FTransform4D
    about special cases when applying non-integral shifts.
  <LI>(UCSF version only) Relaxed the wavelength checks in the deconvolution
    applications.  If the data and transfer function both have non-positive
    wavelengths, issue a warning and proceed as if they have the same
    wavelength.
  <LI>(Internal version only) Incorporated the changes to ER-Decon I that
    Muthuvel Arigovindan made prior to early 2012.
</UL>
<HR>

<H2><A NAME="IVE4.2.9">IVE 4.2.9</A></H2>
<P>Features added in 4.2.9 are:
<UL>
  <LI>In <A HREF="EMCAT/EMTIAR.html">EMTIAR</A> and
    <A HREF="EMCAT/RA.html">RA</A> added the option to weight the forward
    projections to account for density not included in the reconstruction
    volume.
</UL>
<P>Problems fixed in 4.2.9 are:
<UL>
  <LI>Modified Priism so that selecting the option to load a custom color
    table would not cause a crash on Mac OS X 10.5 or later.
  <LI>Corrected 2d_plot so it would not crash when given a plot file with plots
    which had no data points.
  <LI>The command-line application, header, no longer exits with an error if
    an end-of-file is given when the application prompts for the range of
    sections to display from the extended header.
  <LI>In the application to align a single tilt series, no longer stop with
    an error when the input file does not have an extended header and the
    -header option is not used.
  <LI>Modified the header information printed by the IM library so header
    fields would not run together for large values.
  <LI>Modified job submission with controls created by WMAddDoButton() so
    that job script file names that do not start with "/", "./", or "../"
    can be submitted even if the user does not have "." in his or her path.
  <LI>For graphical front-ends which use the IOMENU library, removed a
    confusing second error dialog when background job submission fails while
    writing the job script.
</UL>
<P>Other changes in 4.2.9 are:
<UL>
  <LI>The files in the Linux/x86/LIB/pg and Linux/x86_64/LIB/pg directories
    are now compiled with version 10.2 of the Portland Group compilers rather
    than version 7.2-5.
</UL>
<HR>

<H2><A NAME="IVE4.2.8">IVE 4.2.8</A></H2>
<P>Features added in 4.2.8 are:
<UL>
  <LI>Added Preprocess2D, Preprocess3D, and Preprocess4D as stand-alone
    applications which do the same processing as the preprocessing steps
    incorporated in FFilter2D, FFilter3D, or FFilter4D.
  <LI>In Image Arithmetic, added an option to extract the phase of the
    first input file.
  <LI>Added the option to use TAPIR rather than EWBP in Refine Alignment.  Made
    Refine Alignment available in all versions of Priism.
  <LI>Added 64-bit executables and libraries for Mac OS X systems with
    Intel processors.
  <LI>(internal version only) Added an implementation of Muthuvel Arigovindan's
    CORE algorithm for deconvolution.
</UL>

<P>Problems fixed in 4.2.8 are:
<UL>
  <LI>Expanded fields in Align so shifts up to -999 pixels are displayed in
    their entirety.
  <LI>To mitigate the effects of roundoff error on the results reported by
    Region Min/Max/Mean, use the reported minimum and maximum to constrain
    the reported mean and, for real-valued data, the reported standard
    deviation.
  <LI>Statistics written to the header by reproj (which projects a single-axis
    tilt series) no longer include padding areas stripped off from the result.
  <LI>The graphical front-end for EM alignment and reconstruction (EMTAR), now
    accounts for modifications to the number of processors when generating
    the command to submit a job to a queue.
  <LI>Corrected the Linux version of the plugin for generating Quicktime movies
    so that it does not crash when asked to use one of the codecs based on
    JPEG compression.
  <LI>Rewrote the color selection dialog for BlendColors, ChangeColors, and
    3D Model because interaction with the dialog would not cause the newly
    selected color to be drawn on at least some Mac OS X systems.
  <LI>The Priism setup script did not correctly determine the amount of RAM
    available on many Macs and would choose a smaller shared memory size than
    would be chosen on a similar Linux system.
  <LI>Corrected a coding error that would cause crashes in image windows
    generated by View File when there was an inconsistency between the
    version of the file header in memory and the version of the header on disk.
  <LI>The command-line processing used by some applications would mistakenly
    recognize option strings when they were not at the beginning of an
    argument.
  <LI>Fixed IVEThreadCountProcessors() so it does not always return one on
    Mac OS X.  That will affect the behavior of multithreaded applications that
    used that function to choose the default number of processors to use.
  <LI>(UCSF version only) Corrected imposition of conjugate symmetry
    when interpolating OTFs in the deconvolution applications.
</UL>

<HR>

<H2><A NAME="IVE4.2.7">IVE 4.2.7</A></H2>
<P>Features added in 4.2.7 are:
<UL>
  <LI>In Priism's top-level directory, now generate Priism.command during the
    installation process.  Priism.command will run Priism when double-clicked
    from a file manager in Linux or from the Finder on a Mac.  Also added
    post_install.command which will run post_install.sh when double-clicked
    from a file manager in Linux or from the Finder on a Mac.
  <LI>Added the option to apodize the input in FFilter2D, FFilter3D, and
    FFilter4D.  Added the option to the Gabor filter in the those applications
    to only use one of the two components that are symmetric about the origin.
  <LI>Region Min/Max/Mean now works with complex-valued data.
  <LI>Added an option to reproj to scale the reprojections as if the
    reconstruction was drawn from a larger, nearly uniform, slab of material.
  <LI>The converters to and from .mat files will now work on 64-bit Intel
    Mac systems with Matlab 7.9 (R2009b).
</UL>

<P>Problems fixed in 4.2.7 are:
<UL>
  <LI>Corrected a problem with file positioning for files where the product of
    the x, y, and z dimension sizes was greater than or equal to 2^32.
  <LI>To prevent display problems on some Macs, disable use of stereo-capable
    visuals by default on all systems.
  <LI>Corrected a problem that would cause applications built with the IP
    framework to leave a rectangle graphic in an image window when the
    "Select Region" button was pressed and then the XY region field was edited
    without moving the mouse to the input image window.
  <LI>EditHeader no longer crashes when given a file which claims to have
    more than ten labels in the header.
  <LI>For Pick Points restored the IVE 3.3 behavior for list numbers:
    entering a list number beyond the list numbers already in use will
    generate a new list when a point is added.
</UL>

<P>Other changes in 4.2.7 are:
<UL>
  <LI>Some definitions were moved from IWApiConstants.h to a new header
    file, IWShmConstants.h.  This change will only affect code that
    directly accessed IWApiConstants.h.
  <LI>For Mac OS X systems with Intel processors, the binaries are now
    built on Mac OS X 10.5 (with backwards compatibility for 10.4) rather
    than Mac OS X 10.4 and now use version 10.1 rather than version 9.1 of
    the Intel Fortran compiler.
</UL>

<HR>

<H2><A NAME="IVE4.2.6">IVE 4.2.6</A></H2>
<P>Features added in 4.2.6 are:
<UL>
  <LI>Added a third type of job (GPU) to the existing two (parallel and serial)
    used for configuration of batch queues.
  <LI>Matlab converters will now work with Matlab 7.3.
  <LI>Added options to control the permutation of projections for
    GPU-accelerated reconstructions.
</UL>

<P>Problems fixed in 4.2.6 are:
<UL>
  <LI>Corrected BALIGN and the WM library to avoid crashes in BALIGN after
    selecting a new tilt series.
  <LI>In the EM reconstruction and alignment applications, force the output
    to have one wavelength and time point.
  <LI>Modified EMTAR so that a change to the input tilt series for EWBP,
    TAPIR, or GPURECON does not change the z size of the reconstruction.
  <LI>In tapir, no longer needlessly ignore measurements when the
    reconstruction has fewer samples in x than the measurement does.
  <LI>In 2D Object Finder, changed the test for whether or not a file has
    binary data to look at the minimum and maximum of all processed wavelengths
    in the file rather than the minimum and maximum of the first wavelength.
  <LI>Modified Find Points so it can be run without a full Priism session
    running.
  <LI>In the local contrast enhancement applications, modified the graph
    display to avoid memory accesses past the end of an array.
  <LI>Corrected the handling of file name templates in Image Capture,
    mrc2tiff, mrc2txt, and tiff2mrc:  no longer accept %[width]% as a valid
    substitution pattern since it was not listed as such in the documentation.
  <LI>Modified Volume Builder so renaming an object to another's ID has the
    expected side effects.
  <LI>Corrected radialft_asym to avoid out-of-bounds array access when using
    the -flip option.
  <LI>Corrected the region selection process to avoid occasional assertion
    failures when remotely displaying Priism to another system.
  <LI>Modified the expansion of environment variables
    in the OTF/pupil file name to accept the full range of variable names
    acceptable to the sh shell.
</UL>

<P>Other changes in 4.2.6:
<UL>
  <LI>In the EM alignment and reconstruction interface, changed the default
    parameters for tilt axis determination to include smoothing and phase
    weighting.
  <LI>Changed many of the external libraries used by Priism.  For the user
    interface, now use a modified version of LessTif 0.95.2 rather than
    LessTif 0.95.0.  For Fourier transforms on x86_64 Linux and Intel Mac,
    now use FFTW 3.2.2 rather than FFTW 3.1.2.  For file format conversions,
    now use version 7 of libjpeg rather than version 6 and, on Linux systems,
    use version 1.1.3 of libquicktime rather than version 1.0.2.
  <LI>The x86 Linux version now requires libc 2.3.2 or later.  The archive
    libraries which include Fortran code in Linux/x86/LIB (libimcompat.a,
    libiomenu.a, and libifft.a) were generated with version 9 of the Intel
    Fortran compiler rather than the Portland Group compiler.
  <LI>This version no longer runs on IRIX 6.5.
</UL>
<HR>

<H2><A NAME="IVE4.2.5">IVE 4.2.5</A></H2>
<P>Features added in 4.2.5 are:
<UL>
  <LI>MatToImg now handles arrays stored as signed integers (8, 16, or
    32-bit), unsigned integers (8, 16, or 32-bit), and logicals.  The pixel
    representation for the output is closest match from the available pixel
    formats used by Priism.  ImgToMat now allows selection of how values are
    stored in the MAT file.
  <LI>Added a command-line mode of operation to the Region MMM application.
  <LI>Added weighting options (equivalent to those in ewbp) to the
    backprojection algorithm in gpurecon.
</UL>

<P>Problems fixed in 4.2.5 are:
<UL>
  <LI>Priism 4.2.4 when run on x86_64 Linux systems had some components fail
    with a symbol lookup error for __intel_new_proc_init.
  <LI>The "Print Image" function for image windows incorrectly arranged
    multiple images on the page when the multiple images in the window were
    displayed with the lowest section number in the upper left corner (i.e.
    "text" mode).
  <LI>To better handle the case of submitting EM alignment and reconstruction
    jobs to a remote system where the user's home directory is different than
    on the machine submitting the job, the front-ends just reference the HOME
    environment variable in the default value for the temporary directory
    rather than substituting the current value for the HOME environment
    variable.
  <LI>appl_prm did not set the pixel spacing correctly in the aligned image
    file when reading from a lower resolution of the input tit series.
  <LI>Corrected tapir and reproj:  padding added to projection lines would, in
    some cases, introduce a half pixel misalignment.
  <LI>For tapir, report a cross correlation of zero rather than one when there
    is no data or one of the two compared images has a constant intensity.
  <LI>gpurecon now prints out the R-factor results from
    the servers to the log file.  Changed gpurecon to avoid hanging when one
    or more servers have zero lines to reconstruct.  Corrected gpurecon so the
    last column of data from the projections does contribute to the
    reconstruction.  gpurecon permutes the input projections so
    block-iterative reconstructions do not draw blocks from contiguous ranges
    of tilt angles.
</UL>

<P>Other changes in 4.2.5 are:
<UL>
  <LI>Now include libquicktime files from libquicktime 1.0.2 rather than
    libquicktime 1.0.1.
</UL>

<P><A HREF="#RecentChanges">Return to overview</A>
<HR>

<H2><A NAME="IVE4.2.4">IVE 4.2.4</A></H2>
<P>Features added in 4.2.4 are:
<UL>
  <LI>Allow modification of the threshold the cross-correlation alignment
    uses when trying to reduce the influence of a central peak.  Added option
    to write out cross-correlation peak images from the iterative alignment
    applications.
  <LI>Change the event loop routines in the ive library so thread-safety is
    a decision that can be made at runtime rather than at compile time.  Made
    the event handling routines more flexible by adding the option for work
    procedures and internally generated events.  If you link an application
    against the new ive shared library (or any Priism shared library that
    depends on the ive shared library), it is not guaranteed to run with
    older versions of Priism because older versions of the ive library
    have a different set of library dependencies.   On x86 Linux systems,
    running an application linked against the new ive library but loading
    an older version of the library gives an error that includes the message,
    "_dl_check_map_versions: Assertion `needed != ((void *)0)' failed!".
  <LI>Added IVEGetFreeSpace() and IVEThreadCountProcessors() to the ive
    library.
  <LI>Added multiple threads of execution to the GPU
    reconstruction client so it could overlap communications with the server
    with disk I/O and computation.  Modified the client/server protocol and
    the client software so a convergence factor can be specified for the SART
    algorithm and multiple subsets can be specified for the EM algorithm.
  <LI>Added a version of the Refine Alignment
    application which makes use of servers with graphics cards to accelerate
    the reconstructions and projections.
</UL>

<P>Problems fixed in 4.2.4 are:
<UL>
  <LI>Appending to an existing data set with multiple resolutions with a
    ProcFunc-based application (CopyRegion, Image Arithmetic, ...) left
    corrupted data so discard the lower resolutions when appending.
  <LI>Made several corrections in the tilt axis determination.  For one, print
    out plot results with more decimal places and allow more space for peak
    position printed out in plot titles.  Also remove pairwise plot result if
    it already exists to avoid appending to old results and do not generate
    the pairwise plot results if the file name is "none".
  <LI>Corrected the mass-normalization application so multiple runs which
    fit the tilt offset and use the prior run's parameters as input do not
    cause the tilt angles to increase with each run.  Also suppressed output of
    the baseline curve in the mass-normalization diagnostic plot when the
    baseline is forced to be zero.
  <LI>Using the filtering option in the Refine Alignment application would
    cause an early exit because of improperly quoted arguments to the filter.
  <LI>The tolerances for the fit in the bead alignment scaled inappropriately
    with the number of marked positions.
  <LI>Corrected regression in interactive bead alignment:  predicted position
    of bead not shown in image window for projections where the bead position
    was not marked.
  <LI>Corrected the interactive bead alignment so it is not limited to
    displaying results for fifty beads.
  <LI>Fixed the interactive bead alignment so it would run even if it could not
    write to a terminal.
  <LI>In the bead alignment point editor, now load graphics for all projections
    rather than loading a section at a time.  The change is intended to make
    scrolling through the projections smoother.
  <LI>ccdcor, ffilter and rotfast will now increment the starting
    time index in the header by the offset for the first time point selected
    for processing.  applycal now increments the starting time index in the
    header rather than replacing it with the value of the first time point
    selected for processing.
  <LI>In cases where a Gaussian fit to a point did not use three dimensions,
    Find Points incorrectly set the position for the dimensions that were
    not included in the fit.
  <LI>Find Points would hang in some cases when determining the positions
    with a Gaussian fit.
  <LI>The Slider application now responds to other interactions with the
    slider besides dragging it with the mouse.  Also corrected Slider's
    behavior when run with a command-line argument specifying a single
    image window to manipulate.
  <LI>On Linux, Image Capture would flip the left and right sides of images
    when saving as grayscale to a QuickTime movie.
  <LI>Changed the handling of scroll wheel (internally button 4 and 5
    events) in the image window to consolidate consecutive queued events.
  <LI>Increased default value for IVE_WORKING_UNIT in Priism_setup and
    Priism_setup.sh to tolerate 4096 x 4096 complex data.
  <LI>On Mac OS X systems where hostinfo reports the amount of RAM in
    gigabytes, Priism_setup and Priism_setup.sh would incorrectly set the
    IVE_WORKING_SET environment variable.
  <LI>Added a guard to Priism_setup so it would not clear the path if sourced
    from a sh or bash shell.
  <LI>A dialog size change triggered by a change in the dialog's contents
    caused an application crash on at least one system (Mac OS X 10.3 with
    Apple's X11 1.0).
  <LI>Changed the implementation of IMRtDel() so it would turn a pixel spacing
    of zero for a dimension if the mapping of that dimension to rows, columns,
    or sections was out of bounds.  The prior implementation had undefined
    behavior (including segmentation faults) when the mapping was out of
    bounds.
  <LI>In internal help browser, changed algorithm for locating the topic name to
    match what web browsers do.  Fixes issues accessing some help items from
    2d_plot.
</UL>

<P>Other changes in 4.2.4 are:
<UL>
  <LI>Now use Apple's version of gcc 3.1 when building executables and
    libraries for PowerPC systems running Mac OS X.  Those executables may
    not be compatible with OS X 10.1.
</UL>

<P><A HREF="#RecentChanges">Return to overview</A>
<HR>

<H2><A NAME="IVE4.2.3">IVE 4.2.3</A></H2>

<P>Features added in 4.2.3 are:
<UL>
  <LI>Mac OS X and Linux versions now come with LessTif to simplify
    installation.
  <LI>In the EM alignment and reconstruction applications, added the
    capability to work with a lower resolution version of the projections
    stored in the same file.
  <LI>For the IP framework added an alternate 3D processing mode that takes
    blocks in x, y, and time rather than x, y, and z.  Filter3D, LCE3D, and the
    3D Fourier transform applications (FFilter3D, FPwrSpec3D, FTransform3D)
    make use of this new feature.
  <LI>Added 4D versions of the Fourier transform applications: FFilter4D,
    FPwrSpec4D, and FTransform4D.
  <LI>Added a port of IVE 3.3's object library and the Clouds application.
    Enabled the ability of Pick Points and EditPolygon to generate object
    library files.
  <LI>Added <A HREF="mrc2image2000.html">Import/Export-&gt;Mrc2Image2000</A>
    for converting from Priism's variant of the MRC format to the Image 2000
    variant.
  <LI>Added <A HREF="EditHeader2.html">DataViews-&gt;DataInfo-&gt;Edit Header (any MRC)</A>
    which is similar to EditHeader but able to work with several variants of
    the MRC format.
  <LI>In the tilt axis determination for EM alignment, changed the format
    of the output graph to be compatible with 2D Plot.  Added curves averaging
    across just the negative and positive tilt angle pairs to the output
    graph.  Added the option to generate a separate file with the
    cross-correlation as a function of assumed tilt axis orientation for each
    tilt angle pair.
  <LI>In the EM alignment and reconstruction graphical user interface, added
    an option to display the cross-correlation images and graphs from the tilt
    axis determination.
  <LI>In mrc2ccp4, added an option to set the skew transformation from the
    rotation angles and origin in the Priism header.
  <LI>The converters to Matlab .mat files are now functional on Intel-based
    Macs.
  <LI>Added an option to Straight to allow the user to disable smooth
    transitions at joints in the model since the process of smoothing breaks
    a linear relationship between column number in the output images and
    distance along the model.
  <LI>Added a command-line interface for tiff2mrc and extended the file name
    formats for numbered series of files that tiff2mrc accepts.
  <LI>Added two options to the watershed segmentation algorithm:  one to check
    the neighbors in order of intensity rather relative spatial position and
    another to apply tie breakers to the elements with the same intensity
    when all the elements are sorted.
  <LI>Now use libquicktime 1.0.1 rather than libquicktime 0.9.8 to generate
    QuickTime movies on Linux.
  <LI>Added front-ends
    (<A HREF="EMCAT/EMTAR.html">the GPURECON option in EMTAR</A> and
    <A HREF="EMCAT/EMTIARGPU.html">EMTIARGPU</A>) and client programs
    (<A HREF="EMCAT/GPURECON.html">gpurecon</A> and
    <A HREF="EMCAT/gpureproj.html">gpureproj</A> for interacting with servers
    that use graphics cards to accelerate EM reconstruction calculations.
  <LI>Added a second iterative alignment method for
    EM reconstruction, <A HREF="EMCAT/RA.html">Refine Alignment</A>.  Each
    iteration of this method computes a series of weighted backprojections,
    each of which omits some of the input projections.  The projections of a
    reconstruction are then used to compute the alignment parameters for the
    projections not used to compute the reconstruction.
</UL>

<P>Problems fixed in 4.2.3 are:
<UL>
  <LI>The Priism C shell setup script could break when a local variable masked
    an environment variable.
  <LI>Compressed archives of the Priism binaries now specify a top-level
    directory.
  <LI>Corrected the iomenu graphical user interface (used by ccdcor, bead
    alignment, EM alignment and reconstruction, and others) so that selecting
    a shorter primary input filename does not leave trailing characters in
    the script and log file names.
  <LI>In 2D Plot, added options to better control the display of tick labels.
  <LI>Corrected an off-by-one error in the anisotropic diffusion filter's
    normalize option.
  <LI>In Filter3D, corrected the handling of the statistics in the header
    when appending to an existing file or window.
  <LI>Corrected Find Points so that adjusting the maximum number of points to
    find after finding points does not leave point markers displayed in an
    image window.
  <LI>Modified FFilter2D, FTransform2D, and FPwrSpec2D to avoid disconcerting
    scale changes when appending data in z or time to an existing window.
  <LI>In FFilter3D, FPwrSpec3D, and FTransform3D, corrected padding with a
    ramp along the z direction in frequency space.
  <LI>Corrected FFilter3D so the output was correct when the  z output size
    is not the same as the z input size.
  <LI>Corrected the application of window functions to complex-valued data
    in FPwrSpec3D.
  <LI>Corrected FTransform3D so that it would not ignore a shift that was
    solely along the z axis.  Corrected a problem when applying a shift
    during an inverse (unpacked to real) transform.  Also corrected the
    handling of the z padding value: previous versions would use the y padding
    value instead.
  <LI>In EM alignment and reconstruction, changed the selection of the xz
    region of interest so that picking outside the previous region of interest
    gives a box that can be instantly adjusted with the mouse.  Also changed
    the handling of the default parameter file for xy region selection.
  <LI>The documentation for the EM Alignment File Manipulator incorrectly
    stated the sign convention for shifts.
  <LI>Corrected appl_prm so the combination of not applying the alignment
    parameters and applying a shift or size change to the output works.
  <LI>Modified the interactive version of the final stage of bead alignment
    so errors are correctly adjusted when moving a point near the edge whose
    fit position has been coerced to fall in the image.
  <LI>Removed buffer overflow in the Bead Chaser step of bead alignment when
    the specified radii of the beads is less than four pixels.
  <LI>Changed ewbp and tapir to flag the output reconstructions as normal
    images; this allows viewing of the reconstruction in Chimera without first
    changing the image type field in the header.
  <LI>Changed tapir to report the agreement between the input projections and
    projections from the reconstruction using the normal crystallographic
    formula for the R-factor.  What was reported as the "R-factor" in previous
    versions is also generated to make it easier to compare with old results.
  <LI>In the tilt axis determination step for EM processing, corrected
    the geometric mean calculation across the tilt angle pairs.
  <LI>In the tilt axis determination step for EM processing, now exit with an
    error if no pair of projections matches the criteria specified by the input
    parameters.
  <LI>Corrected an off-by-one error that could cause crashes when generating
    QuickTime movies on Mac OS X from Image Capture or 3D Model.
  <LI>Corrected Line Profile's calculation of profiles in time which averaged
    over multiple z sections and more than one point in x and y.
  <LI>If requested to swap bytes, mrc2ccp4 sets the machine stamp in the file
    appropriately.
  <LI>Rotate3D now sets the starting section index in the header to zero.
  <LI>Changed Volume Builder so it can be run without a full Priism session
    running.
  <LI>The watershed segmentation's internal segmentation routine did not
    adjust the number of regions segmented so far when an early exit was
    forced due to insufficient storage for the attributes of regions.
  <LI>Corrected off-by-one error that affected handling of trailing blanks
    when WMAddCharField or WMAddScrolledText are called from Fortran.
  <LI>Modified the WM library so WMProcEvent will handle Xt timer, input,
    or signal events when the wait argument is zero.
</UL>

<P>Other changes in 4.2.3 are:
<UL>
  <LI>Removed versions of archive libraries (libimcompat.a, libiomenu.a,
    libifft.a, and others) that were compatible with version 7 of the
    Intel compilers for Linux.
</UL>

<P><A HREF="#RecentChanges">Return to overview</A>
<HR>

<H2><A NAME="IVE4.2.2">IVE 4.2.2</A></H2>

<P>Features added in 4.2.2 are:
<UL>
  <LI>Provide native binaries for x86_64 Linux systems and for Intel-based
    Mac OS X systems.
  <LI>In the Processing-&gt;Enhancement menu, added
    <A HREF="ANDiffusion.html">A. N. Diffusion</A>, an implementation of an
    anisotropic nonlinear diffusion filter.
  <LI>In the Import/Export menu, added <A HREF="mrc2spi.html">Mrc2Spider</A>,
    an application to convert Priism's native image format to
    <A HREF="http://www.wadsworth.org/spider_doc/spider/docs/spider.html" TARGET="_top">Spider</A>'s
    native image format, and <A HREF="mrc2ccp4.html">Mrc2CCP4</A>, an
    application to convert Priism's native image format to
    <A HREF="http://www.ccp4.ac.uk/" TARGET="_top">CCP4</A>'s native image format.
  <LI>Introduced a configuration file to configure queues and default
    parallel execution settings.
  <LI>For cluster processing with the parallel EM scripts, now allow input
    and output files to reside in places not visible to all systems in the
    cluster.  Because of the change, the command-line options for cluster
    processing are not backward-compatible with Priism 4.2.0 or 4.2.1.
  <LI>Improved the performance of the weighted backprojection and iterative
    reconstruction applications.
  <LI>In the application to align EM data from fiducial markers, the option to
    fix the z position of the fiducial markers now does just that without
    additional side effects.  There are now additional options so you
    explicitly turn on the additional behavior that in past versions happened
    automatically when fixing the z positions of the markers.
  <LI>Modified the IP framework and most other applications so that when
    generating an image window with a single z section but multiple time
    points, the default step direction is along time.
  <LI>Applications based on the IP framework now have the option to allow
    the user to select which resolution to process.
  <LI>Use <A HREF="http://libquicktime.sourceforge.net" TARGET="_top">libquicktime</A> rather
    than <A HREF="http://heroinewarrior.com/quicktime.php3" TARGET="_top">Quicktime 4 Linux</A>
    to generate Quicktime files on Linux systems.
  <LI>Changed the default help browser on IRIX and Linux to a wrapper script
    that detects whether Firefox, Mozilla, or Netscape is available.
</UL>

<P>Problems fixed in 4.2.2 are:
<UL>
  <LI>Fixed 2D Plot to prevent "Line X of plot file was too long" messages.
  <LI>Changed 3D Model so changes made in the "WT Display Options" dialog
    are immediately reflected in image windows.  Also changed 3D Model
    so image windows are updated when the last object is deleted or the
    point list for the current object is deleted.
  <LI>Corrected the interactive final step of bead alignment to prevent a
    segmentation fault at exit when asked to generate a file with the
    aligned projections.
  <LI>The final step of the bead alignment now accepts beads which only
    appear on two projections (previous versions erroneously required three).
  <LI>Changed CutMask so masks of complex-valued data use 1+0i as the value
    for regions in the mask rather than 1+1i.
  <LI>Corrected the statistics CutMask saves to the output header.
  <LI>Removed memory leak in CutMask when the input has an extended header.
  <LI>Changed the behavior of the expansion step of the simplex algorithm
    used for EM alignments:  the new variant appears to give slightly more
    reliable results than the old.  Also, added one restart of the
    minimization.
  <LI>Modified the tapir front-end to accept a value of zero iterations
    (i.e. simply perform a backprojection).
  <LI>Because the deconvolution expects transfer functions where the pixel
    spacing is in spatial units, added an option to FTransform2D and
    FTransform3D to keep the pixel spacing in spatial units.
  <LI>For centered output from FTransform2D, FTransform3D, FPwrSpec2D,
    and FPwrSpec3D, shuffle the arrays in memory rather than by
    multiple I/O calls in order to improve performance when writing
    to NFS disks.
  <LI>Corrected FFilter3D to prevent a segmentation fault when generating
    a filter profile.
  <LI>Corrected the lower bound on the time range in Edit Polygon's clear
    partial dialog.
  <LI>Modified Find Points and Region Growing to implement checks on whether
    opening outputs for images failed.
  <LI>Fixed instances where Find Points and Volume Builder would leave object
    number labels in an image window.
  <LI>Improved the initial placement of subdialogs in Find Points,
    Straight and Volume Builder.
  <LI>Modified Find Points and Region Growing so that clearing the name
    of a region-growing output file disables that output until a name is
    provided.
  <LI>Corrected the bounds imposed on values in FindPoints z and time fields.
  <LI>Modified Find Points so the initial z and time steps are one rather
    than zero.
  <LI>Made the automated propagation of polygons in Edit Polygon work in
    cases where the destination range has only one time point or does not
    contain the seed section.
  <LI>Corrected problems with Pick Points' handling of copying points between
    wavelengths or time points or using something other than the first
    wavelength and time point when copying points in the same wavelength and
    time point.
  <LI>Removed a buffer overflow in Region Growing that could occur when
    asking the user whether or not to overwrite a file.
  <LI>Modified the filter option in Scale to restore behavior broken in
    IVE 3.3.
  <LI>Modified Scale to update the histogram display in response to selecting
    the 3D histogram or filter options.
  <LI>Modified Straight to prevent crashes if "show model lines" or
    "show current point" is selected and the model was read from a 
     file rather than accessed from main memory.
  <LI>Modified the cookie mode in Straight to reduce missing slivers when
    cutting out a large radius about an object's axis.
  <LI>Modified Straight to not pass along extended header information when
    using the straight or tunnel methods.
  <LI>In Volume Builder, corrected the handling of removing the last polygon
    from an object, removing sibling polygons from an object, and adding
    polygons to an object with no polygons.
  <LI>Tightened bounds checks on values entered in Volume Builder's current
    object field.
  <LI>Modified Volume Builder to display sibling polygons in the correction
    dialog.
  <LI>Changed Volume Builder so that, when renaming the current object, the
    current object will refer to the renamed object.
  <LI>Corrected Volume Builder's highlighting of objects when the user selects
    a new current object.
  <LI>Changed image windows to honor the synchronization of z and time when
    stepping in wavelength.
  <LI>In the IP framework, corrected a consistency check on the z and time
    dimensions that was too loose.
  <LI>Modified the IP framework so the NEW_REGION callback is invoked if a
    change to whether or not an input derives its bounds from the first input
    causes a change to the region processed.  Also modified the IP framework
    so the WAVE_FUNC callback is invoked if a change to whether or not an input
    derives its bounds from the first input causes a change to the wavelengths
    processed.
  <LI>Modified <A HREF="IP.html#IPGetRegionInfoExt">IPGetRegionInfoExt</A> to
    return correct results when processing is not in progress and the caller
    requests information about an input which uses the same region as the first
    input.  Made it clear in the documentation when the values returned by
    <A HREF="IP.html#IPGetRegionInfoExt">IPGetRegionInfoExt</A> are consistent
    with the dimensions in the input's header.
  <LI>Modified the IP framework to prevent a mix of per-section and
    per-wavelength scaling when the first sections written in a wavelength
    have a uniform non-zero value while the remaining sections do not.
  <LI>Protected against I/O errors when generating scripts from IOMENU-based
    interfaces.
</UL>

<P><A HREF="#RecentChanges">Return to overview</A>
<HR>

<H2><A NAME="IVE4.2.1">IVE 4.2.1</A></H2>
<P>Features added in 4.2.1 are:
<UL>
  <LI>Several applications were modified to avoid use of the NAG Fortran 77
    library.  The applications and the computations affected are:
    <UL>
      <LI><A HREF="EMCAT/BEAD_ALIGN.html">Final stage of bead alignment</A>:
        fit of alignment parameters and bead positions
      <LI><A HREF="CCDCor.html">CCDCor</A>:  polynomial fits
      <LI><A HREF="FFilter2D.html">FFilter2D</A>,
        <A HREF="FFilter3D.html">FFilter3D</A>,
        <A HREF="FPwrSpec2D.html">FPwrSpec2D</A>,
        <A HREF="FPwrSpec3D.html">FPwrSpec3D</A>,
        <A HREF="FTransform2D.html">FTransform2D</A>, and
        <A HREF="FTransform3D.html">FTransform3D</A>
      <LI><A HREF="FindPoints.html">FindPoints</A>:  curve fit to histogram
        for thresholds and fitting Gaussian profiles for peak positions
      <LI><A HREF="pffit.html">pffit</A>:  fitting Zernike polynomials to
        pupil function
      <LI><A HREF="simplex.html">simplex</A>: simplex minimization
      <LI><A HREF="SurfHarmMod.html">SurfHarmMod</A>:  fit of spherical
        harmonics to model points
    </UL>
  <LI>In the iterative alignment and reconstruction:
    <UL>
      <LI>Built in the preparation step of computing the mass-normalized
        tilt series.  Removed the ability to specify the image formation
        model and pcbase used when invoking appl_prm in the iterations.
      <LI>Changed the alignment portion to have an option for different
        alignment methods like the non-iterative alignment.  By default,
        the alignment uses the Talign method and only refines the translations.
      <LI>Added an option (on by default) to terminate iterations when the
        reconstruction R-factor increases between subsequent
        alignment+reconstruction iterations.
      <LI>Added an option to carry over the reconstruction between iterations
        rather than restarting tapir without an initial guess at each
        iteration.
      <LI>Added the option to specify an initial guess for the reconstruction.
      <LI>Parallelized the alignment portion.
      <LI>Made it easier to use the parallel execution mode on a single machine
        with multiple processors.
      <LI>Now create the working directory if it does not already exist.
   </UL>
  <LI>EM applications no longer generate the .bprm format and always use the
    .bprmMn format instead.  The applications can still read .bprm format
    input files.
  <LI>Changed the front-end to massnorm so the default is to fit the
    background rather than the mean and to use the entire image for statistics.
    Made fitting of the baseline intensity level optional; the default now
    is to not fit the baseline value.  Reintroduced option to attempt to
    identify and correct for abrupt changes in the intensity as a function of
    tilt angle.
  <LI>Changed the defaults for the cross-correlation alignment to be the
    talign method, .001 for the second peak threshold, and zero for the
    isotropic magnification characteristic length.  Made some adjustments
    to how the cross-correlation peak search deals with a peak at the origin.
  <LI>Modified the scaled linear model in appl_prm to compensate for
    variations in exposure time.  Modified the EM rough alignment to extract
    the exposure times from the extended header and use them to initialize
    the scale parameters in the alignment parameter file.
  <LI>In the weighted backprojection, modified the handling of the mean
    (in the new version calculate the mean line by line rather than for a
    2D slice through the projections), padding (now use a zero pad in all
    cases), and the Hamming filtration boundary condition (now wrap around
    rather than repeating the last element).
  <LI>Extended the alignment file manipulator to be able to compensate for
    image center shifts.
  <LI>Modified components in Priism to generally enforce one of two
    conventions for the sampling frequency entries in the MRC header:
    either each of the entries is equal to the corresponding image dimension
    in pixels or all the entries are set equal to one.  The EM reconstruction
    applications always force their output to follow the first convention.
    To agree with this convention, the Fourier transform and power spectrum
    modules no longer use the sampling frequencies to store the input size
    prior to padding and the Fourier transform.
  <LI>Changed Resample2D so that, by default, it does not preserve the
    cell dimensions.
  <LI>Changed the Fourier transform and power spectrum modules so the
    output pixel spacings are each set equal to one divided by the product
    of the input region size in pixels and the input pixel spacing.  In
    other words, if the input pixel spacings have units of microns, the output
    pixel spacings have units of cycles per micron.  For a forward transform,
    the Fourier transform and power spectrum modules set the origin coordinates
    to the frequencies (in the same units as the output pixel spacing) for
    the pixel in the bottom lower left.  For a reverse transform, the Fourier
    transform modules set the origin coordinates to zero.  
  <LI>Modified the BlendColors user interface.  Selections from the color wheel
    modify the wavelength selected within that dialog rather than relying
    on the wavelength selection controls in the main dialog.  The lowest
    priority wavelength control has been integrated into the main dialog.
    The scaling fields now use the same number of parameters as other
    applications.
  <LI>Added a module for determining the tilt axis orientation to the EM
    alignment and reconstruction suite.
  <LI>Added a parallel version of the weighted backprojection application.
    Made the parallel versions of the weighted backprojection and tapir
    accessible from the alignment and reconstruction front end.
  <LI>Added an application, <A HREF="ResUp.html">IncreaseRes</A>, to
    function as an inverse for ReduceRes without the full generality and
    memory overhead of Rotate3D.
  <LI>Added an application, <A HREF="EMCAT/insert_tilts.html">insert_tilts</A>,
    for adding tilt angle information to data sets that do not have an
    extended header.
  <LI>Added a bilateral filter option to Filter2D and Filter3D.
  <LI>Added command line interfaces for 2DObjFinder, AppendRes, BlendColors,
    FPPolygons, ImageCapture, mrc2tiff, mrc2txt, and ViewFile.
  <LI>Added option to the bead alignment to hold the tilt axis orientation
    fixed.
  <LI>Added option to Flip to control the amount of working space used.
  <LI>Added operations to Image Arithmetic to ease computation of
    the complex conjugate and multiplication by the complex conjugate.
  <LI>Added options in the Priism Color menu to change the image color
    table.  As a side effect, changed the default setting for the image
    background color to be the first color in the palette of colors used
    when drawing on the images.
  <LI>To reduce problems with unintentionally overwriting a previous log or
    script file, added a serial number to log and script names generated by
    IOMENU-based interfaces.
  <LI>Made Matlab utilities compatible with Matlab 7 on Mac OS X and x86 Linux.
    Removed necessity of patching the IRIX version for compatibility with
    Matlab 6.5.
  <LI>Changed the conventions for file selection dialogs so that, with the
    exception of selecting configuration files, the starting directory is
    the last directory visited.
  <LI>On x86 Linux systems, removed runtime dependence on libglut.so.
  <LI>Made Safari the default help browser on Mac OS X.
</UL>

<P>Problems fixed in 4.2.1 are:
<UL>
  <LI>The Priism_setup and Priism_setup.sh scripts failed to recognize 64-bit
    x86 systems.
  <LI>Modified Priism_setup and Priism_setup.sh to use
    DYLD_FALLBACK_LIBRARY_PATH rather than DYLD_LIBRARY_PATH:  avoids a
    problem encountered on Mac OS X 10.4 where Priism would refuse to start
    when /sw/lib was in DYLD_LIBRARY_PATH and the Fink version of Gimp was
    installed.
  <LI>The iterative alignment and reconstruction did not allow specification
    of the positivity-related options for tapir:  it would always coerce
    the input values to be non-negative but did not apply a positivity
    constraint to the reconstruction.
  <LI>The alignment step in the iterative alignment and reconstruction
    generated broken .bprmMn files:  the column titles were printed on
    two lines rather than one.
  <LI>The iterative alignment and reconstruction ignored the input parameters
    specifying a translation of the reconstructed volume.
  <LI>The iterative alignment and reconstruction interface did not respond to
    close requests from the window manager.
  <LI>The extraction of EM alignment parameters from the extended header had
    logic errors in how it handled the case where the data set was collected
    in two chunks and had two different reference points for the shifts.
  <LI>Corrected an error in the alignment and reconstruction front end:
    the r* Hamming option for the weighted backprojection was written out
    without a leading dash.
  <LI>Changed appl_prm and final step of the bead alignment to carry over
    the start indices (with an adjustment to the z index for the first
    projection used) from the input data when writing aligned tilt series.
  <LI>Corrected errors introduced in the 4.2.0 version of massnorm:  fixed to
    pass along user-specified tilt offsets to the output parameter file,
    removed use of an uninitialized variable in the read from an input .bprm
    file, corrected intensity value axis and histogram data in the histogram
    output, removed access past end of an array that caused the program to
    crash on Alpha Linux systems.
  <LI>Changed the histogram calculations in massnorm so they do not assume
    the minimum and maximum in the input data's header are correct.
  <LI>Changed the weighted back projection and tapir modules to set the
    start indices and origin to zero in the reconstruction's header.
  <LI>Corrected tapir so it did not ignore the smoothing option on Linux.
  <LI>Corrected the entries in the "Npos" column of the summary table in
    tapir's log file.  For a particular iteration, the entry in the "Npos"
    column is the fraction of the reconstructed volume that violated the
    positivity constraint for that iteration.  Corrected the summary
    statistics for the cross-correlation results:  these now reflect
    the cross-correlation across all sections and not just the last section.
    When run in parallel, generate cumulative statistics across all chunks.
  <LI>Modified tapir to protect against division by zero in the R-factor
    calculations and in the comparison of the reprojections with the input
    data when a y line only contains pixels flagged as invalid data.
  <LI>Improved the accuracy of the mean value tapir recorded in the
    reconstruction's header.
  <LI>Removed hardwired upper limits on the number of sections from all the
    EM alignment and reconstruction applications with the exception of those
    for bead alignment.
  <LI>Corrected ccdcor and ffilter to carry over the start indices from the
    header of the input and to modify the start indices and origin in the
    header to reflect the region selected for processing.
  <LI>In AppendRes, the computation of the imaginary component in lower
    resolution was incorrect for complex data.  Also, the progress indicator
    was misleading for z downsampling factors greater than one.
  <LI>Fixed logic in BlendColors for tracking when dynamically scaled output
    is open.  Corrected a buffer overflow when dynamically rescaling output.
    Changed to avoid garbling the contents of the graph minimum and maximum
    field.
  <LI>Protected against crash when the user selected the automatic mode in
    EditPolygon.
  <LI>Corrected the test for whether or not a point is inside a polygon.  The
    change affects EditPolygon and FindPoints.
  <LI>Expanded the region outline drawn by Examine Data to include the half
    pixel wide border that is included in the Examine Data display.
  <LI>Protected against a crash in Find Points if no file is open and the
    user selects "curve fit" from the Method menu.
  <LI>Previous versions of Line Profile used a region two times wider than
    indicated when performing the averaging for diagonal profiles.  Removed a
    one pixel shift in many diagonal profiles.  Removed binary characters
    from output files for diagonal profiles.  Modified so image graphics are
    aligned to the pixel centers.  Modified so that when working with multiple
    windows, plots are saved in order of increasing window number.
  <LI>The previous version of RadProj did not correctly handle the radius
    bounds for data sets whose pixel spacings were not all equal to one.
    That version of RadProj would also crash when projecting the sum,
    minimum intensity, or maximum intensity to an image in cylindrical or
    spherical coordinates.
  <LI>Previous versions of ReduceRes crashed when given complex-valued data.
  <LI>Fixed simplex to avoid crash when an output image file is requested
    and there is no second input image file.  Removed binary characters in
    simplex's log output.
  <LI>Corrected strait's allocation and freeing of storage buffers when
    the user selects a new input image window or file.
  <LI>Changed Volume Viewer's allocation of buffers so large movies do not
    cause "IVEShmCalloc fail: Not enough SHM" messages.
  <LI>Fixed Volume Viewer so it does not crash when rescaling the input
    after a preloaded region with a nonzero z starting value has been selected.
  <LI>Added check in Volume Viewer to gracefully handle the case of
    complex-valued data.
  <LI>Modified FPPolygons and 2DObjFinder so the default file browser path
    for polygon files does not interfere with the default file browser path
    for image files.  Modified BlendColors so the default file browser path
    for color files does not interfere with the default file browser path for
    images.
  <LI>Modified the scripts written by IOMENU-based applications to avoid
    undue loss of precision for floating-point parameters.
  <LI>Corrected problems with the chain option help lookup in IOMENU-based
    applications.
  <LI>Tightened check for a preexisting shared memory file for which the
    corresponding Monitor 0 process does not exist.
  <LI>A misplaced return statement caused image windows to read back scaled
    image data that had been buffered and then discard that data to recalculate
    the scaled image.
  <LI>Changed the handling of image window scaling so that the accurate scaling
    mode is always used when the scaling range would be represented by a
    floating-point infinite or not-a-number value.  This prevent image
    window crashes on the Mac when a scaling range of -inf to 0.5 is used.
  <LI>Changed so that image windows report a synthetic window entry event
    if an application requests window entry events and the pointer is already
    over the window.
  <LI>Fixed some instances where the image window failed to clear the
    background appropriately.
  <LI>Fixed image windows so the indicator for jumping to a section is shown
    when the visual is not doublebuffered.
  <LI>Corrected inconsistencies in the handling of the image background color
    when it is the same color as the first color in the image color table.
  <LI>Protected against crashes in the IW library when unable to connect to
    the X server.
  <LI>Protected against X server hangs when a modal dialog is posted at
    the same time a pulldown menu is activated.
  <LI>Modified get_realswitch to tolerate scientific notation with an "e"
    or "E" as the prefix for the exponent.
  <LI>get_realswitch imposed a limit of 50 characters on the length of the
    values to be parsed.  Increased the limit to 256 characters.
</UL>

<P><A HREF="#RecentChanges">Return to overview</A>
<HR>

<H2><A NAME="IVE4.2.0">IVE 4.2.0</A></H2>
<P>Features added in 4.2.0 are:
<UL>
  <LI>Restructured the EM reconstruction front-end to include options for
    getting the alignment parameters from the extended header or to compute
    them based on cross-correlation results.  The mass-normalization step
    in the back-end no longer attempts to fit jumps and has new options
    to limit the region of analysis.
  <LI>Added another EM reconstruction front-end for iterative refinement of
    the alignment parameters and reconstruction.
  <LI>In Volume Viewer's movie dialog, added an option to perform the
    incremental rotations relative to the unrotated coordinate system.
    Changed the rgba/opacity method to use the procedure for scaling the
    output as the progressive method.
  <LI>Added an inverse filtering option to the 2D and 3D Fourier filter
    applications.  Also added a (1-Gaussian)*Gaussian filter like ffilter has.
  <LI>Added calculation of the sample standard deviation to the Region
    Min/Max/Mean application.
  <LI>Added the <A HREF="headit.html">headit application</A> from IVE 3.3 for
    command-line editing of image file header information.
  <LI>Added <A HREF="RadProj.html">RadProj</A>, an application for computing
    radial averages or other projections from Cartesian to polar, cylindrical,
    or spherical coordinates.
  <LI>Added versions of libimcompat, libiomenu, and libifft which are
    compatible with the IBM XL Fortran 8.1 compiler for Mac OS X.
</UL>

<P>Problems fixed in 4.2.0 are:
<UL>
  <LI>Corrected a resource leak (one SYSV semaphore per session on Linux)
    introduced in 4.1.6.
  <LI>Added workaround for incorrect drawing of rectangles in image windows
    on some Imacs (reported for a system using Apple's X11 and an Nvidia FX
    5200).
  <LI>Fixed loading of multiresolution data with ViewFile to avoid memory
    corruption if the data does not have the host's native byte ordering.
  <LI>Removed cause of UtRmImgMem messages when switching from stereo to
    non-stereo mode in Volume Viewer.
  <LI>Fixed the EM reconstruction front-end so the "Change file names" button
    is reliable on Mac OS X.
  <LI>Stretching was applied incorrectly for the display and modification
    of the xy region of interest parallelogram.
  <LI>Fixed an off-by-one error in the EM reconstruction front-end that
    caused an erroneous message to be displayed when picking the xy region
    of interest using the last projection.
  <LI>Fixed a logic problem in appl_prm that caused it to use uninitialized
    values with the scaled linear image formation model.
  <LI>Fixed appl_prm so it gets the correct tilt angles when using the linear
    image formation model and parameters from a .bprmMn file.
  <LI>Modified tapir to accommodate y step sizes other than one.  Fixed pixel
    size set in appl_prm's output when the y step size is not one.
  <LI>Modified tapir so that, if there is no -istrfile option, it assumes
    there is no initial guess.
  <LI>Removed limit of 50 markers per section in the bead_chaser and bead_align
    steps of bead alignment.
  <LI>Fixed a problem in the bead chaser step of bead alignment that could
    cause the application to crash.
  <LI>Fixed the bead alignment step so the option to output an aligned tilt
    series is functional.
  <LI>The 4.1.9 change to Volume Viewer for setting the output size did
    not correctly factor in the zoom factor.
  <LI>Volume Viewer was incompatible with the 3.2 VLI library for the
    VP1000 board.
  <LI>To facilitate modeling or erasing with Volume Viewer's slicer mode,
    the slicer mode now uses the central slice rather than end slice from the
    rendered volume.
  <LI>Fixed problem that caused uniformly bright images in Volume Viewer's
    slicer mode when the volume rendered does not intersect the source volume.
  <LI>Fixed Volume Viewer to update the input scaling dialog if a new input
    file is selected while that dialog is open.
  <LI>Modified the 3D cursor to not reset the z mode on window entry to reduce
    the opportunity for the z mode to get out of sync with Volume Viewer.
    Changed the z mode indicators in Volume Viewer and the 3D cursor to buttons
    so it is possible to manually bring the two in sync.
  <LI>Modified the 3D cursor to avoid missing window exit events.
  <LI>Fixed the 2D and 3D Fourier transform applications so it is not necessary
    to specify the output format when doing a forward transform of real data.
    Corrected an error in those applications when limiting what output pixel
    formats are possible.
  <LI>Corrected the minimum, maximum, and mean values written to the header
    for masked data and region label data generated by FindPoints or Region
    Growing.
  <LI>The command to print an image window now includes the scale bar label
    in the printed output.  However, because the font in the printed output
    does not match the font used on the screen, the output falls short of
    "what you see is what you get".
  <LI>For complex data written by MatToImg, changed the statistics saved to
    the header to only reflect the real components (as CopyRegion does).
  <LI>Modified the ffilter command-line application so it is possible to
    inverse filter with an OTF.
  <LI>Corrected the ffilter front-end so the conditions for enabling and
    disabling the bandpass and smoothing/enhancement filters are the same
    as in the underlying command-line application.
  <LI>Fixed the simplex application to not crash at exit if one image input
    is used.
  <LI>Corrected the handling of "%%" in the file name and label templates
    used by ImageCapture, mrc2tiff, and mrc2txt.
  <LI>To prepare for future versions which use 64-bit addressing, made many
    internal changes for compilation as 64-bit applications and to accommodate
    large shared memory files.
  <LI>Extended the Fortran interface to the WM library so that it has most of
    what the C interface has.  Documented the Fortran interface.
</UL>

<P><A HREF="#RecentChanges">Return to overview</A>
<HR>

</BODY>
</HTML>
