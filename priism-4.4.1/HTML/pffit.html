<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
  <META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <TITLE>Priism Help: pffit</TITLE>
  <META NAME="Description" CONTENT="On-line help for Priism's application to fit a series of Zernike polynomials to a pupil function image.">
  <META NAME="Keywords" CONTENT="Priism,pffit,pupil function,Zernike polynomial">
  <LINK REV=MADE HREF="mailto:ive@msg.ucsf.edu">
</HEAD>
<BODY>

<H1><A NAME="pffit">pffit</A></H1>
<P>pffit fits a series of Zernike polynomials to the phase and amplitude of
a pupil function image (you can use <A HREF="phretavr.html">phretavr</A> to
construct such an image from the slices through a point spread function (PSF)).
The results of the fit can then be used to characterize the imaging system
during deconvolution.  You can use <A HREF="pfimage.html">pfimage</A> to
construct an image of the fit.

<P>To use pffit, invoke it from the command line.  The expected form of the
command line is (optional parts are shown in brackets):

<PRE>
    pffit <VAR>pupil_image_input</VAR> <VAR>fit_output</VAR> \
        [-residual=<VAR>name</VAR>] [-tol=<VAR>t</VAR>] \
        [-w=<VAR>w1</VAR>[:<VAR>w2</VAR>...]] \
        [-zernike_amp=<VAR>n</VAR>[:<VAR>m</VAR>]] \
        [-zernike_phase=<VAR>n</VAR>[:<VAR>m</VAR>]]
</PRE>

<P>or

<PRE>
    pffit -h
</PRE>

<P>where the latter form simply prints a description of the expected input
parameters and then exits.  The meanings of the different entries on the
command line are:

<DL>
  <DT><VAR>pupil_image_input</VAR>
  <DD><VAR>pupil_image_input</VAR> is expected to be the name of the Priism
    image file containing an image of the pupil function to fit.  Conventions
    for pupil function images are described in the
    <A HREF="OTFAndPupil.html#otf_format">OTF and pupil file documentation</A>
  <DT><VAR>fit_output</VAR>
  <DD><VAR>fit_output</VAR> is the name of the file to hold the fit results.
    The file will be text and the
    <A HREF="OTFAndPupil.html#otf_format">OTF and pupil file documentation</A>
    describes the file's format.
  <DT><CODE>-residual=</CODE><VAR>name</VAR>
  <DD>Causes pffit to write an image of the residuals (input pupil function
    minus the fit result) to the file with the given name.  By default, pffit
    does not write the residuals.
  <DT><CODE>-tol=</CODE><VAR>t</VAR>
  <DD>Sets the relative tolerance to use when determining the rank of the
    least-squares problem matrix.  The tolerance should be approximately the
    largest relative error in the pupil function input values.  The default
    tolerance is .0001.
  <DT><CODE>-w=</CODE><VAR>w1</VAR>[<CODE>:</CODE><VAR>w2</VAR>...]
  <DD>Limits the wavelengths to process.  A wavelength may be specified by its
    zero-based index in the input file or by its wavelength.  By default,
    pffit processes all wavelengths in the input.
  <DT><CODE>-zernike_amp=</CODE><VAR>n</VAR>[<CODE>:</CODE><VAR>m</VAR>]
  <DD>Sets the Zernike polynomials used to fit the pupil function amplitude:
    terms whose radial polynomial is less than order n or terms whose radial
    polynomial are order n and whose angular portion have the form k*theta
    where k is in [0, m] are used.  If n is less than zero, the amplitude is
    not fit and is assumed to be uniform within the bounds set by the
    numerical aperture.  If you omit m, pffit will assume it is equal to n.
    By default n is equal to eight and m is equal to zero.
  <DT><CODE>-zernike_phase=</CODE><VAR>n</VAR>[<CODE>:</CODE><VAR>m</VAR>]
  <DD>Sets the Zernike polynomials used to fit the pupil function phase:
    terms whose radial polynomial is less than order n or terms whose radial
    polynomial is order n and whose angular portion have the form k*theta
    where k is in [0, m] are used.  If n is less than zero, the phase is
    not fit and is assumed to be zero within the bounds set by the numerical
    aperture.  If you omit m, pffit will assume it is equal to n.  By default
    n is equal to eight and m is equal to zero.
</DL>

<H2>Related Priism Topics</H2>
<P>
   <A HREF="OTFAndPupil.html">OTF and pupil function documentation</A> |
   <A HREF="phretavr.html">phretavr</A> |
   <A HREF="pfimage.html">pfimage</A> |
   <A HREF="Priism.html">Priism</A>
<HR>

</BODY>
</HTML>
