#!/bin/sh
# This script covers up the different names (netscape, mozilla, firefox)
# for the predominant browser which supports Netscape's remote control
# protocol via X Windows.  It will first attempt to use a cached value
# (in $HOME/.ivebrowser).  If that fails, it searches a builtin list of
# alternatives and selects the first.

if test -n "$HOME" -a -r "$HOME/.ivebrowser"; then
    if test -x `cat "$HOME/.ivebrowser"`; then
        exec `cat "$HOME/.ivebrowser"` "$@"
    fi
fi

# Accumulate command-line options separated by newlines (that means that
# options which include newlines will not be handled correctly).
options=""
while test $# -gt 0; do
    options="$options
$1"
    shift
done

old_ifs="$IFS"
for alternative in firefox mozilla netscape; do
    IFS=:
    set -- $PATH
    IFS="$old_ifs"
    for dir; do
        if test -x "$dir/$alternative"; then
            echo "$dir/$alternative" > "$HOME/.ivebrowser"
            # Just a newline.
            IFS="
"
            set -- $options
            IFS="$old_ifs"
            exec "$dir/$alternative" "$@"
        fi
    done
done

exit 1
